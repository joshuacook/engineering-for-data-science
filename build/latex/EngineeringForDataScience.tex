%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
 \ifdefined\DeclareUnicodeCharacterAsOptional
  \DeclareUnicodeCharacter{"00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{"2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{"2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{"2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{"251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{"2572}{\textbackslash}
 \else
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{2572}{\textbackslash}
 \fi
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}
\addto\captionsenglish{\renewcommand{\tablename}{Table}}
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{1}


% Jupyter Notebook prompt colors
\definecolor{nbsphinxin}{HTML}{303F9F}
\definecolor{nbsphinxout}{HTML}{D84315}
% ANSI colors for output streams and traceback highlighting
\definecolor{ansi-black}{HTML}{3E424D}
\definecolor{ansi-black-intense}{HTML}{282C36}
\definecolor{ansi-red}{HTML}{E75C58}
\definecolor{ansi-red-intense}{HTML}{B22B31}
\definecolor{ansi-green}{HTML}{00A250}
\definecolor{ansi-green-intense}{HTML}{007427}
\definecolor{ansi-yellow}{HTML}{DDB62B}
\definecolor{ansi-yellow-intense}{HTML}{B27D12}
\definecolor{ansi-blue}{HTML}{208FFB}
\definecolor{ansi-blue-intense}{HTML}{0065CA}
\definecolor{ansi-magenta}{HTML}{D160C4}
\definecolor{ansi-magenta-intense}{HTML}{A03196}
\definecolor{ansi-cyan}{HTML}{60C6C8}
\definecolor{ansi-cyan-intense}{HTML}{258F8F}
\definecolor{ansi-white}{HTML}{C5C1B4}
\definecolor{ansi-white-intense}{HTML}{A1A6B2}
\definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
\definecolor{ansi-default-inverse-bg}{HTML}{000000}

% Define "notice" environment, which was removed in Sphinx 1.7.
% At some point, "notice" should be replaced by "sphinxadmonition",
% which is available since Sphinx 1.5.
\makeatletter
\@ifundefined{notice}{%
\newenvironment{notice}{\begin{sphinxadmonition}}{\end{sphinxadmonition}}%
}{}
\makeatother


    \inputencoding{utf8}
    \DeclareUnicodeCharacter{22EF}{$\dots$}
    \usepackage[inline]{enumitem}
    

\title{Engineering For Data Science Documentation}
\date{May 27, 2018}
\release{}
\author{Joshua Cook}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}



\chapter{configuration}
\label{\detokenize{index:configuration}}\label{\detokenize{index:welcome-to-engineering-for-data-science-s-documentation}}

\section{Configuration}
\label{\detokenize{01-amazon-web-services:Configuration}}\label{\detokenize{01-amazon-web-services::doc}}

\subsection{The Modeling Problem and the Engineering Problem}
\label{\detokenize{01-amazon-web-services:The-Modeling-Problem-and-the-Engineering-Problem}}
As a practicing data scientist, it is likely that you spend the bulk of
your time working toward the development of a model for a particular
inference or prediciton application. It is less likely that you spend
time thinking of the equally complex problems stemming from your system
infrastructure. We might trivially think of these two often orthogonal
concerns as the \sphinxstylestrong{modeling problem} and the \sphinxstylestrong{engineering problem}.
The typical data scientist is trained to solve the former, often in an
extremely rigorous manner, but can often wind up developing a series of
ad hoc solutions to the latter.

Since its introduction in 2013, Docker has quickly become a fundamental
tool in the design and deployment of robust engineering infrastructure
for many applications. From the smallest tech shops to Google, Docker is
being used to
\begin{itemize}
\item {} 
modernize traditional software

\item {} 
leverage cloud resources for application architecture

\item {} 
streamline continuous integration and delopyment pipelines

\item {} 
build out microservices

\end{itemize}

These will certainly seem downright esoteric to the Data Scientist who
is typically concerned with feature importances or how many epochs to
run to train a certain neural network.

That said, developing a robust engineering practice with Docker at its
core can only make for better data science. This includes immediate
concerns such as environment configuration and replicability and
presentation of results, but in learning how to use Docker properly the
data scientist can ensure that their work is deployed correctly as part
and product of their team’s software.

Here, I discuss Docker as a tool for the data scientist, in particular
in conjunction with the popular interactive programming platform Jupyter
and the cloud computing platform Amazon Web Services (AWS). Using
Docker, Jupyter and AWS, the data scientist can take control of their
environment configuration, prototype scalable data architectures, and
trivially clone their work toward replicability and communication.


\subsection{Getting Started}
\label{\detokenize{01-amazon-web-services:Getting-Started}}
In this first chapter, you will configure your local system and create
an AWS instance in order to do data science work. To do this work, you
will use the package management system \sphinxcode{\sphinxupquote{conda}}, the containerization
technology Docker, the version control software \sphinxcode{\sphinxupquote{git}} and its
counterpart cloud-based backup service Github.com, and the system design
tool Docker Compose.

There is something of a bootstrap moment in this first chapter. I’m
writing this book using Jupyter notebooks. The goal is that you are able
to read it and execute the very same code from Jupyter notebooks while
you’re reading it. That said, you may not even have a Jupyter running on
your system. The steps here I designed to take you through step-by-step
to install and configure all of the tools you will need to do the work
in this book.


\subsubsection{Prerequisites}
\label{\detokenize{01-amazon-web-services:Prerequisites}}
We will assume a basic knowledge of working in bash. This should include
things like knowing that \sphinxcode{\sphinxupquote{\textasciitilde{}}} is an alias for your home directory, that
\sphinxcode{\sphinxupquote{pwd}} shows your current location, \sphinxcode{\sphinxupquote{cd}} changes directories and
\sphinxcode{\sphinxupquote{ls}} can be used to list files and in a directory.


\subsubsection{Useful tools}
\label{\detokenize{01-amazon-web-services:Useful-tools}}

\paragraph{Bash}
\label{\detokenize{01-amazon-web-services:Bash}}
If you are using a Mac OS X system or a Linux system, you will already
have Bash available to you in an application called Terminal. If you are
using a Windows system, you can use the Anaconda Prompt that will be
installed next. If you are on a Mac, you may want to install iTerm
(\sphinxurl{https://iterm2.com}).


\paragraph{Conda}
\label{\detokenize{01-amazon-web-services:Conda}}
It is recommended that you install \sphinxhref{https://conda.io}{Conda} on your
local system. Conda is a package and environment management system for
Linux, Mac, and Windows and is perfect for managing our local Python
packages. Detailed instructions for installing Conda on your system can
be found here: \sphinxurl{https://conda.io/docs/user-guide/install/index.html}


\paragraph{Atom}
\label{\detokenize{01-amazon-web-services:Atom}}
A simple but extensible text editor such as Atom (\sphinxurl{https://atom.io}) can
be an invaluable tool. Atom is available for any modern operating
system.


\paragraph{\sphinxstyleliteralintitle{\sphinxupquote{vim}}}
\label{\detokenize{01-amazon-web-services:vim}}
Nearly all of the work we will be doing will be on remote systems. It
can be useful to be able to edit text files in place on these remote
systems. We have essentially three options to do this:
\begin{itemize}
\item {} 
Vim

\item {} 
nano

\item {} 
Emacs

\end{itemize}

I will empahsize Vim. Vim is a text editor, like Atom. It is extensible,
if not exactly simple. It is available on nearly every system by
default, but it can be very challenging to learn. With a little
guidance, we will be able to do but we need to do. It should be noted
that we will only be using Vim on remote systems. If you would like to
spend some time acquainting yourself with Vim, you can type \sphinxcode{\sphinxupquote{vimtutor}}
at a Bash prompt.


\subsubsection{SSH Key Pairs}
\label{\detokenize{01-amazon-web-services:SSH-Key-Pairs}}
All of the work that you will be doing will take place remotely. As
such, there is very little configuration to be done for the local
system. The one thing that you will need to do is configure a set of SSH
Keys to enable secure connection to the remote system you bring online.
We will be using the Secure Shell protocol (SSH) to do the vast majority
of our command line work. It is considered a best practice to use an SSH
key pair for authentication when using SSH. An ssh key pair is a set of
two long character strings: a private key and a public key. Though they
are both called keys, I prefer to think of them as a key and lock.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-ssh_keys}.png}
\caption{Connecting with SSH Keys}\label{\detokenize{01-amazon-web-services:id31}}\end{figure}

An SSH Key is a password-less method of authenticating to a remote
system using public-key cryptography. Authentication is done using a key
pair consisting of a public key (\sphinxcode{\sphinxupquote{id\_rsa.pub}}), which can be shared
publicly, and a private key (\sphinxcode{\sphinxupquote{id\_rsa}}), which is known only to the
user (See fig {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:ssh\_keys\}{}`}). One might think of the
public key as the lock on your front door, accessible to anyone, and the
private key as the key in your pocket so that only you are able to open
your door and gain access to your home.

You will generate this key pair on our local system and then provide the
public key to AWS so that it can be added to any system you wish to
launch. You will keep the private key on our local system and use it
whenever you wish to gain access.


\paragraph{Check to See if SSH Key Pair Exists}
\label{\detokenize{01-amazon-web-services:Check-to-See-if-SSH-Key-Pair-Exists}}
You will use the Bash tool \sphinxcode{\sphinxupquote{ssh-keygen}} to create a new key pair. To
begin open a new terminal
session:raw-latex:\sphinxtitleref{footnote\{On a Mac or Linux system, simply open the Terminal application. On Windows, open Anaconda Prompt.\}},
where you will examine whether or not you already have a key pair.
Launching a new Bash session will put us in our home directory. The
canonical location for storing SSH Keys is in a folder called \sphinxcode{\sphinxupquote{\textasciitilde{}/.ssh}}
in our home directory. Note that this directory begins with a \sphinxcode{\sphinxupquote{.}}
which makes it a hidden directory. In Bash Command
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{lst:ls\_home\}{}`}, you use \sphinxcode{\sphinxupquote{ls -la}} to display all of the
contents of your home directory (\sphinxcode{\sphinxupquote{\textasciitilde{}}}) in a list.

We will first check to make sure that you do not already have an SSH key
pair.

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [1]: }\PYG{n}{ls} \PYG{o}{\PYGZhy{}}\PYG{n}{la} \PYG{o}{\PYGZti{}}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
{\ldots}
drwxr-xr-x   21 joshuacook  staff    714 Jul 31  2017 .pylint.d
drwx------   11 joshuacook  staff    374 Jan 28 18:49 .ssh
drwxr-xr-x    6 joshuacook  staff    204 Feb  2 22:01 .vim
-rw-------    1 joshuacook  staff  20788 Feb 10 08:54 .viminfo
-rw-r--r--@   1 joshuacook  staff   1263 Jul 26  2017 .vimrc
drwx------@   5 joshuacook  staff    170 Aug 26 09:12 Applications
drwx------+  19 joshuacook  staff    646 Feb 11 09:32 Desktop
drwx------+   6 joshuacook  staff    204 Feb  4 12:18 Documents
{\ldots}
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

My local system is running Mac OS X and has the \sphinxcode{\sphinxupquote{.ssh}} folder already.
As the directory already exists, in Bash Command
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{lst:ls\_ssh\}{}`}, I list the contents of my \sphinxcode{\sphinxupquote{.ssh}}
directory.

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [4]: }\PYG{n}{ls} \PYG{o}{\PYGZhy{}}\PYG{n}{la} \PYG{o}{\PYGZti{}}\PYG{o}{/}\PYG{o}{.}\PYG{n}{ssh}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
total 24
drwxr-xr-x  8 jovyan users  272 Apr 24 23:07 .
drwxr-xr-x 21 jovyan users  714 Apr 25 00:39 ..
-rw-------  1 jovyan users 1679 Apr 24 23:06 id\_rsa
-rw-r--r--  1 jovyan users  418 Apr 24 23:06 id\_rsa.pub
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

As can be seen, I already have an SSH Keypair named \sphinxcode{\sphinxupquote{id\_rsa}} and
\sphinxcode{\sphinxupquote{id\_rsa.pub}}. If this is true for you, as well, you should skip the
next step and not create new SSH Keys. If you do not have these keys,
proceed to Bash Command {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{lst:create\_new\_ssh\_key\}{}`}.


\paragraph{Create a new SSH Key Pair}
\label{\detokenize{01-amazon-web-services:Create-a-new-SSH-Key-Pair}}
If when listing the home directory, you do not see a folder called
\sphinxcode{\sphinxupquote{.ssh}} or when displaying the contents of \sphinxcode{\sphinxupquote{.ssh}} you do not see an
SSH Keypair named \sphinxcode{\sphinxupquote{id\_rsa}} and \sphinxcode{\sphinxupquote{id\_rsa.pub}}, a new SSH Keypair will
need to be created. In Bash Command
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{lst:create\_new\_ssh\_key\}{}`}, you create a new SSH Keypair
using the \sphinxcode{\sphinxupquote{ssh-keygen}} command line utility.

During the creation of the SSH Keypair, you will be prompted three
times. The first asks where you should save the SSH Keypair, defaulting
to the \sphinxcode{\sphinxupquote{.ssh/id\_rsa}} in our home directory. In Bash Command
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{lst:create\_new\_ssh\_key\}{}`}, you see that this is being
done at \sphinxcode{\sphinxupquote{/Users/joshuacook/.ssh/id\_rsa}} on my local system where my
username is \sphinxcode{\sphinxupquote{joshuacook}}. The second and third prompts will ask for a
passphrase to be added to the key. For our purposes, leaving this
passphrase empty will be fine. In other words, the default options are
preferable and you may simply hit \sphinxcode{\sphinxupquote{\textless{}ENTER\textgreater{}}} three times.

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [1]: }\PYG{n}{ssh}\PYG{o}{\PYGZhy{}}\PYG{n}{keygen}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
Generating public/private rsa key pair.
Enter file in which to save the key (/Users/joshuacook/.ssh/id\_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in id\_rsa.
Your public key has been saved in id\_rsa.pub.
The key fingerprint is:
SHA256:p5KeEomPt6izFC5gaFphfx3zw8aAB+D8RiUA1/nEsUc joshuacook@LOCAL
The key's randomart image is:
+---[RSA 2048]----+
|  ..++ooo.E      |
|   +  o=oo       |
|  o o oo* .      |
|.. o o o.O       |
|o+{\ldots}+ S B      |
|*.o oo . + .     |
|oo o .o .        |
|+ ..+. o         |
|o+{\ldots}oo          |
+----[SHA256]-----+
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

You can verify the SSH Keypair you just created by displaying the Public
Key in our shell (See Bash Command {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{lst:cat\_pub\_key\}{}`}).
Here, you use the \sphinxcode{\sphinxupquote{cat}} command, which concatenates the contents of
\sphinxcode{\sphinxupquote{id\_rsa.pub}} to the shell output.

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [1]: }\PYG{n}{cat} \PYG{o}{\PYGZti{}}\PYG{o}{/}\PYG{o}{.}\PYG{n}{ssh}\PYG{o}{/}\PYG{n}{id\PYGZus{}rsa}\PYG{o}{.}\PYG{n}{pub}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
ssh-rsa
AAAAB3NzaC1yc2EAAAADAQABAAABAQDdnHPEiq1a4OsDDY+g9luWQS8pCjBmR
64MmsrQ9MaIaE5shIcFB1Kg3pGwJpypiZjoSh9pS55S9LckNsBfn8Ff42ALLj
R8y+WlJKVk/0DvDXgGVcCc0t/uTvxVx0bRruYxLW167J89UnxnJuRZDLeY9fD
OfIzSR5eglhCWVqiOzB+OsLqR1W04Xz1oStID78UiY5msW+EFg25Hg1wepYMC
JG/Zr43ByOYPGseUrbCqFBS1KlQnzfWRfEKHZbtEe6HbWwz1UDL2NrdFXxZAI
XYYoCVtl4WXd/WjDwSjbMmtf3BqenVKZcP2DQ9/W+geIGGjvOTfUdsCHennYI
EUfEEP joshuacook@LOCAL
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

That is the sum of the local configuration you will need to do in order
to get started.


\subsection{Amazon Web Services}
\label{\detokenize{01-amazon-web-services:Amazon-Web-Services}}
If you have not already done so, set up an AWS
account:raw-latex:\sphinxtitleref{footnote\{As of 2017/12/19, detailed instructions for doing this can be obtained here: https://aws.amazon.com/premiumsupport/knowledge-center/create-and-activate-aws-account/\}}.
You will be using AWS to manage the hardware upon which your data
science platform will run. We will leave the details of what exactly
“hardware” means to AWS. This is to say that AWS may be allocating
resources as a virtual machine, but for your purposes, the experience
will be as if you are using a physical system across the room from you.

The most popular service offered by Amazon Web Services is the Elastic
Compute Cloud (EC2), “a web service that provides secure, resizable
compute capacity in the
cloud”{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}footnote\{https://aws.amazon.com/ec2/\}{}`}. For our
purposes, compute capacity means a cloud-based computer you will use to
run your platform. What we learn should generalize to other cloud
providers such as DigitalOcean or Google cloud platform.

If you are new to AWS you will be able to work through this text using
the AWS Free Tier:raw-latex:\sphinxtitleref{footnote\{https://aws.amazon.com/free/\}}.
For the first 12 months following sign up, new users receive 750 Hours
per month of EC2 time. This amounts to 31.25 days of availability and,
provided that readers keep only one server running at a time, ensures
that readers can work through this text at no cost.


\subsubsection{Configure your AWS Account}
\label{\detokenize{01-amazon-web-services:Configure-your-AWS-Account}}
The next thing you will need to do is configure your AWS Account.

This will involve:
\begin{enumerate}
\item {} 
Configure a Key Pair

\item {} 
Creating a Security Group

\end{enumerate}

The AWS Key Pair is slightly misnamed as it is not in fact a pair, but
rather is simply the public portion of the SSH Key Pair you have on our
local system. You will simply add the Public Key from the SSH Key Pair
you just created.

To begin, log in to your AWS control panel and navigate to the EC2
control panel (fig. {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:access\_ec2\_dash\}{}`}). First,
access “Services” (fig. {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:access\_ec2\_dash\}{}`}, \#1) then
access “EC2” (fig. {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:access\_ec2\_dash\}{}`}, \#2). The
Services link can be accessed from any page in the AWS website.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-access_ec2_dash}.png}
\caption{Access EC2 Dashboard}\label{\detokenize{01-amazon-web-services:id32}}\end{figure}


\paragraph{Configure a Key Pair}
\label{\detokenize{01-amazon-web-services:Configure-a-Key-Pair}}
Once at the EC2 control panel, access the Key Pairs pane using either
link (fig. {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:access\_key\_pairs\}{}`}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-access_key_pairs}.png}
\caption{Access Key Pairs from the EC2 control panel}\label{\detokenize{01-amazon-web-services:id33}}\end{figure}

From the Key Pairs pane, choose “Import Key Pair.” This will activate a
modal that you can use to create a new key pair associated with a region
on your AWS account. Make sure to give the key pair a computer-friendly
name, like \sphinxcode{\sphinxupquote{from-MacBook-2018}}. Paste the contents of your public key
(\sphinxcode{\sphinxupquote{id\_rsa.pub}}) into the public key contents. Prior to clicking Import,
your key should appear as in fig.
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:import\_public\_key\}{}`}. Click Import to create the new
key.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-import_public_key}.png}
\caption{Import a New Public Key}\label{\detokenize{01-amazon-web-services:id34}}\end{figure}

You have just created a key pair between AWS and your local system. When
you create a new instance, you will instruct AWS to provision the
instance with this public key and thus you will be able to access the
cloud-based system from your local system using your private key.


\paragraph{Ports \& Security Groups}
\label{\detokenize{01-amazon-web-services:Ports-_-Security-Groups}}
A security group is a set of ports public facing Internet. This may be a
new concept for you and we will not dig very deeply into it. Suffice it
to say that we need a short list of ports to be available to us for
accessing the different services we might configure. A port is a number
appended to an IP address or domain name with a colon like this

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mf}{192.168}\PYG{o}{.}\PYG{l+m+mf}{99.100}\PYG{p}{:}\PYG{l+m+mi}{3000}
\end{sphinxVerbatim}

Here, \sphinxcode{\sphinxupquote{192.168.99.100}} is the IP address and \sphinxcode{\sphinxupquote{3000}} is the port. A
port can be thought of as a channel over which a service will listen for
requests. You have already been using a few ports without knowing that
you are. All internet traffic is routed using ports 80 and 443 by
default. What this means is that visiting \sphinxurl{http://google.com:80} is
equivalent to visiting \sphinxurl{http://google.com} and visiting
\sphinxurl{http://google.com:443} is equivalent to visiting \sphinxurl{https://google.com}.

As we are largely concerned with learning, we are not concerned with the
specifics of high\textendash{}availability, and for us networking best practices
will consist of making sure that things work. If you intend on putting
work that you do here into production, you should certainly consult with
your local Site Reliability Engineer.

For security purposes, by default Amazon closes all ports to outside
traffic. This is why we will need to create a security group to open the
ports that we need. These include the following:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
port
&\sphinxstyletheadfamily 
service
\\
\hline
\sphinxcode{\sphinxupquote{22}}
&
ssh
\\
\hline
\sphinxcode{\sphinxupquote{80}}
&
http
\\
\hline
\sphinxcode{\sphinxupquote{443}}
&
https
\\
\hline
\sphinxcode{\sphinxupquote{5000}}
&
miscellaneous
\\
\hline
\sphinxcode{\sphinxupquote{5432}}
&
PostgreSQL
\\
\hline
\sphinxcode{\sphinxupquote{6379}}
&
Redis
\\
\hline
\sphinxcode{\sphinxupquote{8888}}
&
Jupyter
\\
\hline
\sphinxcode{\sphinxupquote{27017}}
&
Mongo
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\paragraph{Create a New Security Group}
\label{\detokenize{01-amazon-web-services:Create-a-New-Security-Group}}
From the EC2 Control panel, access Security Groups (See fig.
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:ch-01-access\_security\_group\}{}`}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-access_security_group}.png}
\caption{Access Security Groups from the EC2 control panel}\label{\detokenize{01-amazon-web-services:id35}}\end{figure}

From the Security Group pane, click “Create Security Group.” Give the
security group a computer friendly group name like \sphinxcode{\sphinxupquote{ds\_engineering}}.
Give the security group a description like “Open access to important
Data Science related services”. Use the default VPC.

Access the Inbound tab (See fig.
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:ch\_01-create\_new\_security\_group\}{}`}, \#1) and
configure the security rules listed above. \sphinxstylestrong{Make sure to set Source to
“Anywhere”}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch_01-create_new_security_group}.png}
\caption{Create a New Security Group}\label{\detokenize{01-amazon-web-services:id36}}\end{figure}


\chapter{Elastic Compute Cloud}
\label{\detokenize{index:elastic-compute-cloud}}

\section{Elastic Compute Cloud}
\label{\detokenize{02-elastic-compute-cloud:Elastic-Compute-Cloud}}\label{\detokenize{02-elastic-compute-cloud::doc}}

\subsection{Launch a New AWS EC2 Instance}
\label{\detokenize{02-elastic-compute-cloud:Launch-a-New-AWS-EC2-Instance}}

\subsubsection{AWS EC2 \sphinxstyleliteralintitle{\sphinxupquote{t2.micro}}}
\label{\detokenize{02-elastic-compute-cloud:AWS-EC2-t2.micro}}
AWS EC2 virtual machines are available to meet a host of different
applications and purposes. The \sphinxcode{\sphinxupquote{m}} series and the \sphinxcode{\sphinxupquote{t}} series are
considered in general purpose and are adequate for our needs.
Additionally, the \sphinxcode{\sphinxupquote{t2.micro}} from the \sphinxcode{\sphinxupquote{t}} series is considered a
machine “free-tier” and can be run for free under certain circumstances.
We will use this type of machine as often as possible.


\subsubsection{Launch Instance}
\label{\detokenize{02-elastic-compute-cloud:Launch-Instance}}
To create a new instance, start from the EC2 control panel and click the
Launch Instance button (fig. {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:launch\_instance\}{}`}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-launch_instance}.png}
\caption{Begin the launch process for a new instance}\label{\detokenize{02-elastic-compute-cloud:id32}}\end{figure}


\subsubsection{Step 1: Choose an Amazon Machine Image (AMI)}
\label{\detokenize{02-elastic-compute-cloud:Step-1:-Choose-an-Amazon-Machine-Image-(AMI)}}
The launching of a new instance is a multi-step process that walks the
user through all configurations necessary. The \sphinxstylestrong{first tab} is “Choose
AMI.” An AMI is an Amazon Machine
Image:raw-latex:\sphinxtitleref{footnote\{http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html\}}.
and contains the software you will need to run your sandbox machine. I
recommend choosing the latest stable Ubuntu Server release that is
free-tier eligible. At the time of writing, this was ami-efd0428f,
Ubuntu Server 16.04 LTS (HVM), SSD Volume Type (fig.
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:latest\_ubuntu\}{}`}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-latest_ubuntu}.png}
\caption{Choose the latest stable Ubuntu Server release as AMI}\label{\detokenize{02-elastic-compute-cloud:id33}}\end{figure}


\subsubsection{Step 2: Choose Instance Type}
\label{\detokenize{02-elastic-compute-cloud:Step-2:-Choose-Instance-Type}}
The \sphinxstylestrong{second tab} is “Choose Instance Type.” In practice, I have found
that the free tier, \sphinxcode{\sphinxupquote{t2.micro}} (fig.
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:choose\_type\}{}`}), is sufficient for many
applications. Furthermore, the instance type may always be changed later
should the need present itself.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-choose_type}.png}
\caption{Choose \sphinxcode{\sphinxupquote{t2.micro}} for Instance Type}\label{\detokenize{02-elastic-compute-cloud:id34}}\end{figure}


\subsubsection{Step 3: Configure Instance Details}
\label{\detokenize{02-elastic-compute-cloud:Step-3:-Configure-Instance-Details}}
The \sphinxstylestrong{third tab}, “Configure Instance,” can be safely ignored.


\subsubsection{Step 4: Add Storage}
\label{\detokenize{02-elastic-compute-cloud:Step-4:-Add-Storage}}
The \sphinxstylestrong{fourth tab} is “Add Storage.” This option is also specific to
intended usage. It should be noted that Jupyter Docker images can take
up more than 5GB of disk space in the local image cache. For this
reason, it is recommended to raise the value from the default 8GB to
30GB. Furthermore, as noted on this tab:
\begin{quote}

Free tier eligible customers can get up to 30 GB of EBS General
Purpose (SSD) or Magnetic storage.
\end{quote}


\subsubsection{Step 5: Add Tags}
\label{\detokenize{02-elastic-compute-cloud:Step-5:-Add-Tags}}
The fifth tab, “Add Tags,” can be safely ignored.


\subsubsection{Step 6: Configure Security Group}
\label{\detokenize{02-elastic-compute-cloud:Step-6:-Configure-Security-Group}}
The sixth tab, “Configure Security Group,” is critical for the proper
functioning of your systems. By default this tab will be set up to
“Create a \sphinxstylestrong{new} security group”. This will not work for us!
Ultimately, we will be accessing our system via a web browser which we
require at a minimum that port 80 is open. We recommend simply using the
default group which will open our system on all ports. If greater
security is required for your specific application a more restrictive
security group may be defined and used.

Select the “default” security group (fig.
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:default\_security\_group\}{}`}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-default_security_group}.png}
\caption{Choose the latest stable Ubuntu Server release as AMI}\label{\detokenize{02-elastic-compute-cloud:id35}}\end{figure}

\(\square\) \sphinxstylestrong{Note:} You may receive a Warning stating, “Rules with
source of 0.0.0.0/0 allow all IP addresses to access your instance. We
recommend setting security group rules to allow access from known IP
addresses only.” This is expected and is okay.


\subsubsection{Step 7: Review Instance Launch}
\label{\detokenize{02-elastic-compute-cloud:Step-7:-Review-Instance-Launch}}
Finally, click “Review and Launch.” Here, you see the specific
configuration of the EC2 instance you will be creating. Verify that you
are creating a \sphinxcode{\sphinxupquote{t2.micro}} (fig.
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:review\_and\_launch\}{}`}, \#2)running the latest free
tier-eligible version of Ubuntu Server (fig.
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:review\_and\_launch\}{}`}, \#1)and that it is available to
all traffic (fig. {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:review\_and\_launch\}{}`}, \#3), and
then click the Launch button (fig.
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:review\_and\_launch\}{}`}, \#4).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-review_and_launch}.png}
\caption{Review and launch the new instance}\label{\detokenize{02-elastic-compute-cloud:id36}}\end{figure}


\subsubsection{Add an SSH Key}
\label{\detokenize{02-elastic-compute-cloud:Add-an-SSH-Key}}
In a final confirmation step, you will see a modal titled “Select an
existing key pair or create a new key pair.” Select the key pair you
previously created. Check the box acknowledging access to that key pair
and launch the instance (fig. {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:add\_key\_pair\}{}`}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-add_key_pair}.png}
\caption{Add a key pair to the instance}\label{\detokenize{02-elastic-compute-cloud:id37}}\end{figure}

\(\square\) \sphinxstylestrong{Note:} If this step is not done correctly, that is,
if the correct key pair is not added to the launching instance, the
instance will need to be terminated and a new instance will need to be
launched. There is now way to add a key pair to a running instance.

You should see a notification that the instance is now running. Click
the View Instances tab in the lower right corner to be taken to the EC2
Dashboard Instances pane, where you should see your new instance
running.


\subsubsection{Examing the Newly Launched Instance}
\label{\detokenize{02-elastic-compute-cloud:Examing-the-Newly-Launched-Instance}}
Make note of the IP address of the new instance (fig.
{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:new\_ip\}{}`}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-new_ip}.png}
\caption{Add a key pair to the instance}\label{\detokenize{02-elastic-compute-cloud:id38}}\end{figure}


\paragraph{Configure Git \& Github}
\label{\detokenize{02-elastic-compute-cloud:Configure-Git-_-Github}}
Armed with our new ssh key, we will add the public key to Github so that
we can use the key to access our github account.
\begin{enumerate}
\item {} 
copy the public key

\item {} 
choose

\end{enumerate}

The first thing we will do is create a new local \sphinxcode{\sphinxupquote{git}} repository and
a remote Github repository. The local repository is where we will do all
of our work. We will use the remote Github repository to track all of
the work that we will do. It is a common beginning misconception to
think of \sphinxcode{\sphinxupquote{git}} and Github as the same thing. \sphinxcode{\sphinxupquote{git}} is a commond line
tool we will use to track changes to our project. Github is a
cloud-based service designed to work with \sphinxcode{\sphinxupquote{git}} to help us to make
sure our work is always backed up on an additional system.


\subsubsection{Create the new repository on Github}
\label{\detokenize{02-elastic-compute-cloud:Create-the-new-repository-on-Github}}
At github.com, in the upper-right hand corner, click the plus icon and
select “New Repository”.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{newrepo}.png}
\end{figure}

Give your new repository a name. It does not need to match
\sphinxcode{\sphinxupquote{engineering-for-data-science}}, but it is generally considered a best
practice to make sure the repository on Github and the local directory
containing your files have the same name. You do not need to provide a
description nor create a \sphinxcode{\sphinxupquote{README}} file.

Finally, click “Create Repository”.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{Create_a_New_Repository}.png}
\end{figure}


\subsubsection{Make a new directory}
\label{\detokenize{02-elastic-compute-cloud:Make-a-new-directory}}
We use the \sphinxcode{\sphinxupquote{mkdir}} command to create a new directory to hold our work.

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [9]: }\PYG{n}{mkdir} \PYG{o}{\PYGZhy{}}\PYG{n}{p} \PYG{n}{engineering}\PYG{o}{\PYGZhy{}}\PYG{k}{for}\PYG{o}{\PYGZhy{}}\PYG{n}{data}\PYG{o}{\PYGZhy{}}\PYG{n}{science}
\end{Verbatim}


\subsubsection{Change directories to the new directory}
\label{\detokenize{02-elastic-compute-cloud:Change-directories-to-the-new-directory}}
Next, use the \sphinxcode{\sphinxupquote{cd}} (change directory) command to change directories to
the new directory we just created.

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [10]: }\PYG{n}{cd} \PYG{n}{engineering}\PYG{o}{\PYGZhy{}}\PYG{k}{for}\PYG{o}{\PYGZhy{}}\PYG{n}{data}\PYG{o}{\PYGZhy{}}\PYG{n}{science}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [11]: }\PYG{n}{git} \PYG{n}{init}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
Initialized empty Git repository in /home/jovyan/engineering-for-data-science/.git/
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [12]: }\PYG{n}{mkdir} \PYG{n}{chapter}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}\PYG{o}{\PYGZhy{}}\PYG{n}{introduction}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [13]: }\PYG{n}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{.ssh}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZgt{}} \PYG{o}{.}\PYG{n}{gitignore}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [14]: }\PYG{n}{ls}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
chapter-01-introduction
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [15]: }\PYG{n}{ls} \PYG{o}{\PYGZhy{}}\PYG{n}{la}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
total 4
drwxr-xr-x  5 jovyan users 170 Apr 24 23:53 .
drwxr-xr-x 20 jovyan users 680 Apr 24 23:51 ..
drwxr-xr-x  2 jovyan users  68 Apr 24 23:52 chapter-01-introduction
drwxr-xr-x 10 jovyan users 340 Apr 24 23:51 .git
-rw-r--r--  1 jovyan users   5 Apr 24 23:53 .gitignore
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [16]: }\PYG{n}{git} \PYG{n}{add} \PYG{o}{.}\PYG{n}{gitignore} \PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}} \PYG{n}{git} \PYG{n}{commit} \PYG{o}{\PYGZhy{}}\PYG{n}{m} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{initialize project}\PYG{l+s+s1}{\PYGZsq{}}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]

*** Please tell me who you are.

Run

  git config --global user.email "you@example.com"
  git config --global user.name "Your Name"

to set your account's default identity.
Omit --global to set the identity only in this repository.

fatal: empty ident name (for <jovyan@eb5eb401ee58.(none)>) not allowed
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [17]: }\PYG{n}{git} \PYG{n}{config} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{k}{global} \PYG{n}{user}\PYG{o}{.}\PYG{n}{email} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{me@joshuacook.me}\PYG{l+s+s2}{\PYGZdq{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [18]: }\PYG{n}{git} \PYG{n}{config} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{k}{global} \PYG{n}{user}\PYG{o}{.}\PYG{n}{name} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Joshua Cook}\PYG{l+s+s2}{\PYGZdq{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [19]: }\PYG{n}{git} \PYG{n}{add} \PYG{o}{.}\PYG{n}{gitignore} \PYG{o}{\PYGZam{}}\PYG{o}{\PYGZam{}} \PYG{n}{git} \PYG{n}{commit} \PYG{o}{\PYGZhy{}}\PYG{n}{m} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{initialize project}\PYG{l+s+s1}{\PYGZsq{}}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
[master (root-commit) 970c61e] initialize project
 1 file changed, 1 insertion(+)
 create mode 100644 .gitignore
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [20]: }\PYG{n}{git} \PYG{n}{remote} \PYG{n}{add} \PYG{n}{origin} \PYG{n}{git}\PYG{n+nd}{@github}\PYG{o}{.}\PYG{n}{com}\PYG{p}{:}\PYG{n}{joshuacook}\PYG{o}{/}\PYG{n}{engineering}\PYG{o}{\PYGZhy{}}\PYG{k}{for}\PYG{o}{\PYGZhy{}}\PYG{n}{data}\PYG{o}{\PYGZhy{}}\PYG{n}{science}\PYG{o}{.}\PYG{n}{git}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [21]: }\PYG{n}{git} \PYG{n}{push} \PYG{o}{\PYGZhy{}}\PYG{n}{u} \PYG{n}{origin} \PYG{n}{master}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
Counting objects: 3, done.
Writing objects: 100\% (3/3), 222 bytes | 0 bytes/s, done.
Total 3 (delta 0), reused 0 (delta 0)
To git@github.com:joshuacook/engineering-for-data-science.git
 * [new branch]      master -> master
Branch master set up to track remote branch master from origin.
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{joshuacook_engineering-for-data-science}.png}
\end{figure}


\subsection{Git and Github}
\label{\detokenize{02-elastic-compute-cloud:Git-and-Github}}
As you work through this text, you will be developing a series of data
science projects. Tracking software development work is typically done
using version control software. One of the most popular version control
tools is \sphinxcode{\sphinxupquote{git}}. Additonally, it can be useful to use a version control
hosting service as a remote backup for work being tracked using \sphinxcode{\sphinxupquote{git}}.
The remote service we will use is Github.com. In my experience, learners
who are new to version control often confuse \sphinxcode{\sphinxupquote{git}} and Github, so it
bares repeating \textendash{} we will use \sphinxcode{\sphinxupquote{git}} to track changes we make to our
code and Github as a remote backup for these changes.


\subsection{Configuring Github}
\label{\detokenize{02-elastic-compute-cloud:Configuring-Github}}
We will assume that you have a Github account. Once this has been done,
you will need to configue an SSH connection between AWS and Github. This
next part may potentially create a confusion. We are actually going to
need a new SSH Keypair, this one associated with our AWS instance. This
is because it is our AWS instance that will be connecting to Github, not
our local machine (See fig. {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:ssh\_local\_remote\}{}`}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{ch-01-ssh_local_remote}.png}
\caption{SSH Connections}\label{\detokenize{02-elastic-compute-cloud:id39}}\end{figure}


\subsubsection{Create a New Key Pair}
\label{\detokenize{02-elastic-compute-cloud:Create-a-New-Key-Pair}}
In {[}@lst:create\_new\_ssh\_key\_remote{]}, you create a new key pair on
your remote AWS instance. In {[}@lst:ssh\_into\_new\_instance{]}, you
connect to your new AWS instance. To do this we will use the IP address
we made note of in fig. {\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}ref\{fig:new\_ip\}{}`}. We use SSH to
connect to our remote AWS instance. Note that we use the username,
\sphinxcode{\sphinxupquote{ubuntu}}, the default username for the Ubuntu 16 AMI provided by AWS.

Listing: Create a new SSH Keypair

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} ssh ubuntu@54.244.109.176
Welcome to Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0\PYGZhy{}64\PYGZhy{}generic x86\PYGZus{}64)
\end{sphinxVerbatim}

\(\square\) \sphinxstylestrong{Note:} The first time you access your EC2 instance,
you should see the following message:
\sphinxcode{\sphinxupquote{The authenticity of host '54.244.109.176 (54.244.109.176)' can't be established ... Are you sure you want to continue connecting (yes/no)? This is expected. You should hit \textless{}ENTER\textgreater{} to accept or type yes and hit \textless{}ENTER\textgreater{}.}}

In {[}@lst:create\_new\_ssh\_key\_remote{]}, you create a new SSH Keypair on
our remote AWS instance. Again, during the creation of the SSH Keypair,
you will be prompted three times. The first asks where you should save
the SSH Keypair, defaulting to the \sphinxcode{\sphinxupquote{.ssh/id\_rsa}} in our home
directory. In {[}@lst:create\_new\_ssh\_key\_remote{]}, you see that this is
being done at
\sphinxcode{\sphinxupquote{/home/ubuntu/.ssh/id\_rsa}}{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}footnote\{This should be the same for everyone now, as you should be working on an AWS \textbackslash{}texttt\{t2.micro\} running an Ubuntu system where the user's name is \textbackslash{}texttt\{ubuntu\}\}{}`}.
The second and third prompts will ask for a passphrase to be added to
the key. For our purposes, leaving this passphrase empty will be fine.
In other words, the default options are preferable and you may simply
hit \sphinxcode{\sphinxupquote{\textless{}ENTER\textgreater{}}} three times.

Listing: Create a new SSH Keypair

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} ssh\PYGZhy{}keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/home/ubuntu/.ssh/id\PYGZus{}rsa):
Created directory \PYGZsq{}/home/ubuntu/.ssh\PYGZsq{}.
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/ubuntu/.ssh/id\PYGZus{}rsa.
Your public key has been saved in /home/ubuntu/.ssh/id\PYGZus{}rsa.pub.
The key fingerprint is:
SHA256:ZSpFpgSRgRqlQom8yVBG2dZo1tgkPQdrmUGgMXGDtRY
ubuntu@ip\PYGZhy{}172\PYGZhy{}31\PYGZhy{}43\PYGZhy{}19
The key\PYGZsq{}s randomart image is:
+\PYGZhy{}\PYGZhy{}\PYGZhy{}[RSA 2048]\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}+
\textbar{}o=XBE/*.o        \textbar{}
\textbar{}==+=O**O.        \textbar{}
\textbar{}=o++o *o. o      \textbar{}
\textbar{}o+ . . . +       \textbar{}
\textbar{}      . S        \textbar{}
\textbar{}       .         \textbar{}
\textbar{}                 \textbar{}
\textbar{}                 \textbar{}
\textbar{}                 \textbar{}
+\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}[SHA256]\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}+
\end{sphinxVerbatim}

As before, you can verify the SSH Keypair you just created by displaying
the Public Key in your shell ({[}@lst:cat\_pub\_key\_remote{]}). Again, you
use the \sphinxcode{\sphinxupquote{cat}} command, which concatenates the contents of
\sphinxcode{\sphinxupquote{id\_rsa.pub}} to the shell output.

Listing: Display Public SSH Key

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} cat \PYGZti{}/.ssh/id\PYGZus{}rsa.pub
ssh\PYGZhy{}rsa
AAAAB3NzaC1yc2EAAAADAQABAAABAQDQ896GUMgCMAIW79gwF3ojRjcUYCKUKc8b+q
iQlah2jtr7s0K4WRGjktOy3lCCHO+1UK/GrzY1Y4VxCKoKJDH3G9N5UzyGhlxa/2Ah
kKxzHht1knyh/mkVGqYUhuHpXfxUQAstCFrIdp3G0MDPiko2qeJcBF7JSv1lLMbIuM
XuVU/Mzq6BU+tEogScYytmLckyEe1j8RJ+e5nBURwmkgj3UAN1DzmU/lVwLlltEpmC
DlOel4yEXAw8yBwM3GwjahfiBThvBHpsc43HxWrkM8Yi/kdDnvsDZYxU4zhXZPsPab
UY/LfxEod9c6Sui5W8GtAfdi6krnqbzxrKt81Mradh ubuntu@ip\PYGZhy{}172\PYGZhy{}31\PYGZhy{}43\PYGZhy{}19
\end{sphinxVerbatim}


\subsubsection{Add the Public Key to Github}
\label{\detokenize{02-elastic-compute-cloud:Add-the-Public-Key-to-Github}}
Previously, you added your local SSH public key to your AWS account.
Now, you will add your AWS SSH public key to your Github
account:raw-latex:\sphinxtitleref{footnote\{https://help.github.com/articles/adding-a-new-ssh-key-to-your-github-account/\}}.
First, access the \sphinxstylestrong{Settings} for your account by clicking the profile
photo in the upper-right corner of any page on Github. Next, in the user
settings sidebar, select \sphinxstylestrong{SSH and GPG keys}. On the SSH and GPG Keys
page, click \sphinxstylestrong{New SSH key}. On the next page, give your key a
descriptive title e.g. “AWS Feb 2018” and then paste your AWS public key
in to the “Key” field . Finally, click \sphinxstylestrong{Add SSH key} and confirm your
Github password , if prompted.


\subsubsection{Learning to read the Bash Prompt}
\label{\detokenize{02-elastic-compute-cloud:Learning-to-read-the-Bash-Prompt}}
During your work you will no doubt notice that an idle SSH connection
may become disconnected and/or unresponsive. Should this happen, simply
close the terminal session, launch a new one, and reconnect to the
remote instance.

The most important thing is that you are aware of which system your
current shell session is connected to. Shell prompts are designed to
relay this information to you immediately. If you are new to working
with Bash, you may need to train yourself to being aware of the prompt
when typing. {[}@lst:default\_AWS\_prompt{]} shows the default AWS Bash
prompt. The information contained is the username, \sphinxcode{\sphinxupquote{ubuntu}}, and the
private IP address of the AWS instance. \sphinxstylestrong{This is not the public address
you use to connect}. What is useful about this, is that we can
immediately see that the user is \sphinxcode{\sphinxupquote{ubuntu}}. This tells us we are
connected to AWS.

Listing: The default AWS Bash prompt

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
ubuntu@ip\PYGZhy{}172\PYGZhy{}31\PYGZhy{}21\PYGZhy{}89:\PYGZti{}\PYGZdl{}
\end{sphinxVerbatim}

Your local system will no doubt display something different (See
{[}@lst:other\_prompt{]}). Again, the important thing is to take note of
what is displayed by the prompt and to learn to associate that prompt
with the correct system. As you become a more advanced Bash user, you
may wish to personalize your prompt, but for now it is imperative that
you learn to read the prompt in order to always know to which system you
are connected.

Listing: A local Bash prompt

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
joshuas\PYGZhy{}macbook\PYGZhy{}pro:\PYGZti{}\PYGZdl{}
\end{sphinxVerbatim}


\subsubsection{Test your SSH Connection to Github}
\label{\detokenize{02-elastic-compute-cloud:Test-your-SSH-Connection-to-Github}}
Having added you AWS Public Key to your Github account, you should
verify your SSH connection from your AWS instance. In
{[}@lst:verify\_github\_ssh{]}, we attempt to connect to Github via SSH. As
before, we receive a message about the authenticity of the connection.
Again, type \sphinxcode{\sphinxupquote{yes}}, and continue. If successful, you will see a message
telling you have successfully authenticated but that Github does not
provide shell access.

Listing: Verify Github SSH Key

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
ubuntu@ip\PYGZhy{}172\PYGZhy{}31\PYGZhy{}21\PYGZhy{}89:\PYGZti{}\PYGZdl{} ssh \PYGZhy{}T git@github.com
The authenticity of host \PYGZsq{}github.com (IP ADDRESS)\PYGZsq{} can\PYGZsq{}t be
established.
RSA key fingerprint is
16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48.
Are you sure you want to continue connecting (yes/no)? yes
Hi username! You\PYGZsq{}ve successfully authenticated, but GitHub does
not provide shell access.
\end{sphinxVerbatim}


\paragraph{Docker \& Docker Compose}
\label{\detokenize{02-elastic-compute-cloud:Docker-_-Docker-Compose}}
Having configured our SSH connections and provisioned a new AWS EC2
instance, it is time to get to the business of building your data
science platform. To do this you will use the containerization platform
Docker and its Docker Compose tool. While Docker is very easy to use, it
can be difficult to understand for the uninitiated. In an earlier work,
\sphinxstyleemphasis{Docker for Data
Science}{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}footnote\{https://www.apress.com/us/book/9781484230114\}{}`},
I wrote:
\begin{quote}

{[}Using Docker{]} we add a layer of complexity to our software, but in
doing so gain the advantage of ensuring that our local development
environment will be identical to any possible environment into which
we would deploy the application.
\end{quote}

It may be simpler, however, to simply think about using Docker as a way
to manage a running process. Your system will be running two processes:
an IPython shell and a PostgreSQL server. Were you to not use Docker,
you would need to ensure that the AWS instance had all of the libraries
required to run both of those processes (and keep those libraries up to
date).

Instead, you will let Docker manage the processes using a container for
each process. Each respective container will be run using a predefined
image built using best practices and ready to run their respective
process. The exchange is this: you will take on the congitive burden of
\sphinxstyleemphasis{understanding} what Docker is doing and Docker (and the Docker
community) will take over the burden of making sure that your processes
run.


\subsection{Docker Compose}
\label{\detokenize{02-elastic-compute-cloud:Docker-Compose}}
Docker Compose is a tool built for managing an application consisting of
multiple containers. Using Docker Compose, it is possible to completely
define an application using a simple text file. To make this
conversation less abstract, let’s have a look at the
\sphinxcode{\sphinxupquote{docker-compose.yml}} file you will use to define your first
application (See {[}@lst:docker\_compose{]}).

Listing: Your Data Science Application

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{version}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{3}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{services}\PYG{p}{:}
  \PYG{n}{ipython\PYGZus{}shell}\PYG{p}{:}
    \PYG{n}{image}\PYG{p}{:} \PYG{n}{jupyter}\PYG{o}{/}\PYG{n}{scipy}\PYG{o}{\PYGZhy{}}\PYG{n}{notebook}
  \PYG{n}{database}\PYG{p}{:}
    \PYG{n}{image}\PYG{p}{:} \PYG{n}{postgres}
    \PYG{n}{volumes}\PYG{p}{:}
      \PYG{o}{\PYGZhy{}} \PYG{n}{postgres\PYGZus{}data}\PYG{p}{:}\PYG{o}{/}\PYG{n}{var}\PYG{o}{/}\PYG{n}{lib}\PYG{o}{/}\PYG{n}{postgresql}\PYG{o}{/}\PYG{n}{data}
\PYG{n}{volumes}\PYG{p}{:}
  \PYG{n}{postgres\PYGZus{}data}
\end{sphinxVerbatim}

That’s it. This simple file completely defines a fully-functioning Data
Science Application. In it, we define the two services we need:
\sphinxcode{\sphinxupquote{ipython\_shell}} and \sphinxcode{\sphinxupquote{database}}. These two services are defined using
the \sphinxcode{\sphinxupquote{jupyter/scipy-notebook}} and \sphinxcode{\sphinxupquote{postgres}} images. When we launch
the application, the images will be pulled from Docker Hub into our
local memory and then launched. The one other thing we do is create a
data volume \sphinxcode{\sphinxupquote{postgres\_data}}. We will use this as the data volume for
our database server so that if for some reason we have to shut our
system down, we do not lose our data. The data will exist on this volume
independent of the services.

\(\square\) \sphinxstylestrong{Note:} Throughout this text, when discussing
infrastructure, I may casually refer to containers, services, and
processes. At the risk of annoying your local site reliability engineer,
you may treat these as terms as synonomous. Care should be taken,
however, not to confuse services/containers/processes and images. An
image defines a service, but a service should be thought of as a living
and active thing. You may loosely compare the service-image relationship
to the object-class relationship in Object-Oriented Programming. A
service is a running container defined by an image, just like an object
is an instance of a class that exists in memory.


\subsection{Installing and Configuring Docker}
\label{\detokenize{02-elastic-compute-cloud:Installing-and-Configuring-Docker}}
Installing Docker on your AWS instance is a downright trivial process.
It consists of running an install script that can be obtained from
Docker and then adding your user to the Docker group. In
{[}@lst:install\_docker{]}, we run these two commands. First, we download
the install script from \sphinxurl{https://get.docker.com}, then immediately pipe
the script into the shell (\sphinxcode{\sphinxupquote{\textbar{} sh}}).

\(\square\) \sphinxstylestrong{Note:} It is generally considered to be a significant
security vulnerability to execute arbitrary code obtained from an
unknown, or untrusted source. For our purposes, the source
(\sphinxurl{https://get.docker/com}) is considered trustworthy, we are using SSL to
perform the curl, and in practice this is the method I use to install
Docker. Still, it may make the security minded more comfortable to
\sphinxcode{\sphinxupquote{curl}} the script, inspect, and then run it.

Listing: Install Docker via a Shell Script

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} curl \PYGZhy{}sSL https://get.docker.com/ \textbar{} sh
\PYGZsh{} Executing docker install script, commit: 1d31602
+ sudo \PYGZhy{}E sh \PYGZhy{}c apt\PYGZhy{}get update \PYGZhy{}qq \PYGZgt{}/dev/null
...

Client:
 Version:   18.02.0\PYGZhy{}ce
 API version:   1.36
 Go version:    go1.9.3
 Git commit:    fc4de44
 Built: Wed Feb  7 21:16:33 2018
 OS/Arch:   linux/amd64
 Experimental:  false
 Orchestrator:  swarm

Server:
 Engine:
  Version:  18.02.0\PYGZhy{}ce
  API version:  1.36 (minimum version 1.12)
  Go version:   go1.9.3
  Git commit:   fc4de44
  Built:    Wed Feb  7 21:15:05 2018
  OS/Arch:  linux/amd64
  Experimental: false

...
\end{sphinxVerbatim}

When the script completes there is one last thing to be done. In
{[}@lst:add\_to\_docker\_group{]}, you add the \sphinxcode{\sphinxupquote{ubuntu}} user to the
\sphinxcode{\sphinxupquote{docker}} group. By default, the command line docker client will
require sudo access in order to issue commands to the docker daemon. You
can add the \sphinxcode{\sphinxupquote{ubuntu}} user to the \sphinxcode{\sphinxupquote{docker}} group in order to allow
the \sphinxcode{\sphinxupquote{ubuntu}} user to issue commands to docker without sudo.

Listing: Add the Ubuntu User to the Docker Group

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} sudo usermod \PYGZhy{}aG docker ubuntu
\end{sphinxVerbatim}

Finally, in order to force the changes to take effect, you should
disconnect and reconnect to their remote system. You can achieve this by
typing \sphinxcode{\sphinxupquote{exit}} or \sphinxcode{\sphinxupquote{ctrl-d}} and then reconnecting via ssh to your EC2
instance.


\subsection{Installing and Configuring Docker}
\label{\detokenize{02-elastic-compute-cloud:Installing-and-Configuring-Docker}}
Recall that regardless of your local operating system, you are working
on an AWS EC2 Instance running the Linux variant, Ubuntu. As such,
\sphinxcode{\sphinxupquote{docker-compose}}can be installed using the instructions provided
here: \sphinxurl{https://github.com/docker/compose/releases}, which are written
specifically for Linux machines. As of the writing of this book, this
consists of two steps.

In {[}@lst:curl\_docker\_compose{]}, you use \sphinxcode{\sphinxupquote{curl}} to retrieve the
\sphinxcode{\sphinxupquote{docker-compose}} binary from Github. As of the writing of this book.
the latest version of \sphinxcode{\sphinxupquote{docker-compose}} was \sphinxcode{\sphinxupquote{1.19.0}}. You should
retrieve the latest version from the above url.

Listing: Retrieve \sphinxcode{\sphinxupquote{docker-compose}} binary from Github

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} sudo curl \PYGZhy{}L https://github.com/docker/compose/releases/download/1.19.0/docker\PYGZhy{}compose\PYGZhy{}{}`uname \PYGZhy{}s{}`\PYGZhy{}{}`uname \PYGZhy{}m{}` \PYGZhy{}o /usr/local/bin/docker\PYGZhy{}compose
\end{sphinxVerbatim}

In {[}@lst:chmod\_docker-compose{]}, we use the
\sphinxcode{\sphinxupquote{chmod}}{\color{red}\bfseries{}:raw-latex:{}`\textbackslash{}footnote\{The unix "change mode" utility. I pronounce it "shmod".\}{}`}
utility to allow \sphinxcode{\sphinxupquote{docker-compose}} to be executed (\sphinxcode{\sphinxupquote{+x}}).

Listing: Enable Docker Compose to be Executed

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} sudo chmod +x /usr/local/bin/docker\PYGZhy{}compose
\end{sphinxVerbatim}

Finally, in {[}@lst:docker\_compose\_version{]}, we check the version of
\sphinxcode{\sphinxupquote{docker-compose}} against what we expect to have installed.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} docker\PYGZhy{}compose \PYGZhy{}v
docker\PYGZhy{}compose version 1.19.0, build 9e633ef
\end{sphinxVerbatim}

\sphinxstylestrong{TODO}
\begin{enumerate}
\item {} 
What went wrong here? What should you do?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{failed} \PYG{n}{to} \PYG{n}{register} \PYG{n}{layer}\PYG{p}{:} \PYG{n}{Error} \PYG{n}{processing} \PYG{n}{tar} \PYG{n}{file}\PYG{p}{(}\PYG{n}{exit} \PYG{n}{status} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
\PYG{n}{write} \PYG{o}{/} \PYG{n}{usr}\PYG{o}{/}\PYG{n+nb}{bin}\PYG{o}{/}\PYG{n}{python2}\PYG{o}{.}\PYG{l+m+mi}{7}\PYG{p}{:} \PYG{n}{no} \PYG{n}{space} \PYG{n}{left} \PYG{n}{on} \PYG{n}{device}
\end{sphinxVerbatim}

\item {} 
What went wrong here? What should you do?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{docker}\PYG{p}{:} \PYG{n}{Error} \PYG{n}{response} \PYG{k+kn}{from} \PYG{n+nn}{daemon}\PYG{p}{:} \PYG{n}{driver} \PYG{n}{failed} \PYG{n}{programming} \PYG{n}{external}
\PYG{n}{connectivity} \PYG{n}{on} \PYG{n}{endpoint} \PYG{n}{cocky\PYGZus{}swartz} \PYG{p}{(}\PYG{l+m+mi}{08124}\PYG{n}{b75d2f031def6d36c6bc819549c009}
\PYG{l+m+mf}{391e3}\PYG{n}{bd76f3fe3b4e06e11be6fbad}\PYG{p}{)}\PYG{p}{:} \PYG{n}{Bind} \PYG{k}{for} \PYG{l+m+mf}{0.0}\PYG{o}{.}\PYG{l+m+mf}{0.0}\PYG{p}{:}\PYG{l+m+mi}{80} \PYG{n}{failed}\PYG{p}{:} \PYG{n}{port} \PYG{o+ow}{is}
\PYG{n}{already} \PYG{n}{allocated}\PYG{o}{.}
\end{sphinxVerbatim}

\item {} 
What doe this command do?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{curl} \PYG{o}{\PYGZhy{}}\PYG{n}{sSL} \PYG{n}{https}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{get}\PYG{o}{.}\PYG{n}{docker}\PYG{o}{.}\PYG{n}{com} \PYG{o}{\textbar{}} \PYG{n}{sh}
\end{sphinxVerbatim}

\item {} 
What are two ways to display the contents of a text file from the
command line?

\item {} 
What are the two modes in vim?

\item {} 
How do you save the changes in a file in vim?

\item {} 
How would you find all files in your current directory that contain
the string “bash”?

\item {} 
What are the steps to launching a Jupyter Notebook Server on a
running AWS instance?

\end{enumerate}


\chapter{MongoDB}
\label{\detokenize{index:mongodb}}
\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [1]: }\PYG{o}{!}pip install pymongo
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
Collecting pymongo
  Using cached https://files.pythonhosted.org/packages/30/f9/78dd244df932309299288a452d1c3524f6f7746f1813b8a8417952b1d9ce/pymongo-3.6.1-cp36-cp36m-manylinux1\_x86\_64.whl
Installing collected packages: pymongo
Successfully installed pymongo-3.6.1
\textcolor{ansi-yellow}{You are using pip version 9.0.1, however version 10.0.1 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.}
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [2]: }\PYG{k+kn}{from} \PYG{n+nn}{pymongo} \PYG{k}{import} \PYG{n}{MongoClient}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [3]: }\PYG{n}{mongo\PYGZus{}client} \PYG{o}{=} \PYG{n}{MongoClient}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{18.236.138.158}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{27016}\PYG{p}{)}
        \PYG{n}{database\PYGZus{}reference} \PYG{o}{=} \PYG{n}{mongo\PYGZus{}client}\PYG{o}{.}\PYG{n}{twitter}
        \PYG{n}{collection\PYGZus{}reference} \PYG{o}{=} \PYG{n}{database\PYGZus{}reference}\PYG{o}{.}\PYG{n}{tweets}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [4]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{find}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [7]: }\PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[7]: }\PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a4d56d9bfe2f9001587a130\PYGZsq{}),
         \PYGZsq{}created\PYGZus{}at\PYGZsq{}: \PYGZsq{}Wed Jan 03 22:16:04 +0000 2018\PYGZsq{},
         \PYGZsq{}id\PYGZsq{}: 948679379957223427,
         \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}948679379957223427\PYGZsq{},
         \PYGZsq{}text\PYGZsq{}: \PYGZsq{}It’s okay to invest in YOUrself. \PYGZbs{}nI beat myself up whenever i don’t cross out everything on my… https://t.co/9kQpNWp4F9\PYGZsq{},
         \PYGZsq{}source\PYGZsq{}: \PYGZsq{}\PYGZlt{}a href=\PYGZdq{}http://instagram.com\PYGZdq{} rel=\PYGZdq{}nofollow\PYGZdq{}\PYGZgt{}Instagram\PYGZlt{}/a\PYGZgt{}\PYGZsq{},
         \PYGZsq{}truncated\PYGZsq{}: False,
         \PYGZsq{}in\PYGZus{}reply\PYGZus{}to\PYGZus{}status\PYGZus{}id\PYGZsq{}: None,
         \PYGZsq{}in\PYGZus{}reply\PYGZus{}to\PYGZus{}status\PYGZus{}id\PYGZus{}str\PYGZsq{}: None,
         \PYGZsq{}in\PYGZus{}reply\PYGZus{}to\PYGZus{}user\PYGZus{}id\PYGZsq{}: None,
         \PYGZsq{}in\PYGZus{}reply\PYGZus{}to\PYGZus{}user\PYGZus{}id\PYGZus{}str\PYGZsq{}: None,
         \PYGZsq{}in\PYGZus{}reply\PYGZus{}to\PYGZus{}screen\PYGZus{}name\PYGZsq{}: None,
         \PYGZsq{}user\PYGZsq{}: \PYGZob{}\PYGZsq{}id\PYGZsq{}: 61891630,
          \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}61891630\PYGZsq{},
          \PYGZsq{}name\PYGZsq{}: \PYGZsq{}IG: Lorenamour64\PYGZsq{},
          \PYGZsq{}screen\PYGZus{}name\PYGZsq{}: \PYGZsq{}Lorena64o\PYGZsq{},
          \PYGZsq{}location\PYGZsq{}: \PYGZsq{}NORTH HOLLYWOOD\PYGZsq{},
          \PYGZsq{}url\PYGZsq{}: \PYGZsq{}https://www.goherbalife.com/lramirez2/en\PYGZhy{}US\PYGZsq{},
          \PYGZsq{}description\PYGZsq{}: \PYGZsq{}LA I turned bad habits into good habits. Health Coach \textbar{} karaoke queen \textbar{} noceur \PYGZsq{},
          \PYGZsq{}translator\PYGZus{}type\PYGZsq{}: \PYGZsq{}none\PYGZsq{},
          \PYGZsq{}protected\PYGZsq{}: False,
          \PYGZsq{}verified\PYGZsq{}: False,
          \PYGZsq{}followers\PYGZus{}count\PYGZsq{}: 337,
          \PYGZsq{}friends\PYGZus{}count\PYGZsq{}: 239,
          \PYGZsq{}listed\PYGZus{}count\PYGZsq{}: 10,
          \PYGZsq{}favourites\PYGZus{}count\PYGZsq{}: 574,
          \PYGZsq{}statuses\PYGZus{}count\PYGZsq{}: 3164,
          \PYGZsq{}created\PYGZus{}at\PYGZsq{}: \PYGZsq{}Fri Jul 31 22:28:02 +0000 2009\PYGZsq{},
          \PYGZsq{}utc\PYGZus{}offset\PYGZsq{}: \PYGZhy{}28800,
          \PYGZsq{}time\PYGZus{}zone\PYGZsq{}: \PYGZsq{}Pacific Time (US \PYGZam{} Canada)\PYGZsq{},
          \PYGZsq{}geo\PYGZus{}enabled\PYGZsq{}: True,
          \PYGZsq{}lang\PYGZsq{}: \PYGZsq{}en\PYGZsq{},
          \PYGZsq{}contributors\PYGZus{}enabled\PYGZsq{}: False,
          \PYGZsq{}is\PYGZus{}translator\PYGZsq{}: False,
          \PYGZsq{}profile\PYGZus{}background\PYGZus{}color\PYGZsq{}: \PYGZsq{}050108\PYGZsq{},
          \PYGZsq{}profile\PYGZus{}background\PYGZus{}image\PYGZus{}url\PYGZsq{}: \PYGZsq{}http://pbs.twimg.com/profile\PYGZus{}background\PYGZus{}images/812409981/afaa27bf78e5a0e0f394e29f6ca71e2c.jpeg\PYGZsq{},
          \PYGZsq{}profile\PYGZus{}background\PYGZus{}image\PYGZus{}url\PYGZus{}https\PYGZsq{}: \PYGZsq{}https://pbs.twimg.com/profile\PYGZus{}background\PYGZus{}images/812409981/afaa27bf78e5a0e0f394e29f6ca71e2c.jpeg\PYGZsq{},
          \PYGZsq{}profile\PYGZus{}background\PYGZus{}tile\PYGZsq{}: False,
          \PYGZsq{}profile\PYGZus{}link\PYGZus{}color\PYGZsq{}: \PYGZsq{}FF0000\PYGZsq{},
          \PYGZsq{}profile\PYGZus{}sidebar\PYGZus{}border\PYGZus{}color\PYGZsq{}: \PYGZsq{}FFFFFF\PYGZsq{},
          \PYGZsq{}profile\PYGZus{}sidebar\PYGZus{}fill\PYGZus{}color\PYGZsq{}: \PYGZsq{}E3E2DE\PYGZsq{},
          \PYGZsq{}profile\PYGZus{}text\PYGZus{}color\PYGZsq{}: \PYGZsq{}634047\PYGZsq{},
          \PYGZsq{}profile\PYGZus{}use\PYGZus{}background\PYGZus{}image\PYGZsq{}: True,
          \PYGZsq{}profile\PYGZus{}image\PYGZus{}url\PYGZsq{}: \PYGZsq{}http://pbs.twimg.com/profile\PYGZus{}images/921581872206954496/QksJ\PYGZus{}AK\PYGZus{}\PYGZus{}normal.jpg\PYGZsq{},
          \PYGZsq{}profile\PYGZus{}image\PYGZus{}url\PYGZus{}https\PYGZsq{}: \PYGZsq{}https://pbs.twimg.com/profile\PYGZus{}images/921581872206954496/QksJ\PYGZus{}AK\PYGZus{}\PYGZus{}normal.jpg\PYGZsq{},
          \PYGZsq{}profile\PYGZus{}banner\PYGZus{}url\PYGZsq{}: \PYGZsq{}https://pbs.twimg.com/profile\PYGZus{}banners/61891630/1423650146\PYGZsq{},
          \PYGZsq{}default\PYGZus{}profile\PYGZsq{}: False,
          \PYGZsq{}default\PYGZus{}profile\PYGZus{}image\PYGZsq{}: False,
          \PYGZsq{}following\PYGZsq{}: None,
          \PYGZsq{}follow\PYGZus{}request\PYGZus{}sent\PYGZsq{}: None,
          \PYGZsq{}notifications\PYGZsq{}: None\PYGZcb{},
         \PYGZsq{}geo\PYGZsq{}: \PYGZob{}\PYGZsq{}type\PYGZsq{}: \PYGZsq{}Point\PYGZsq{}, \PYGZsq{}coordinates\PYGZsq{}: [34.04491223, \PYGZhy{}118.44241261]\PYGZcb{},
         \PYGZsq{}coordinates\PYGZsq{}: \PYGZob{}\PYGZsq{}type\PYGZsq{}: \PYGZsq{}Point\PYGZsq{}, \PYGZsq{}coordinates\PYGZsq{}: [\PYGZhy{}118.44241261, 34.04491223]\PYGZcb{},
         \PYGZsq{}place\PYGZsq{}: \PYGZob{}\PYGZsq{}id\PYGZsq{}: \PYGZsq{}3b77caf94bfc81fe\PYGZsq{},
          \PYGZsq{}url\PYGZsq{}: \PYGZsq{}https://api.twitter.com/1.1/geo/id/3b77caf94bfc81fe.json\PYGZsq{},
          \PYGZsq{}place\PYGZus{}type\PYGZsq{}: \PYGZsq{}city\PYGZsq{},
          \PYGZsq{}name\PYGZsq{}: \PYGZsq{}Los Angeles\PYGZsq{},
          \PYGZsq{}full\PYGZus{}name\PYGZsq{}: \PYGZsq{}Los Angeles, CA\PYGZsq{},
          \PYGZsq{}country\PYGZus{}code\PYGZsq{}: \PYGZsq{}US\PYGZsq{},
          \PYGZsq{}country\PYGZsq{}: \PYGZsq{}United States\PYGZsq{},
          \PYGZsq{}bounding\PYGZus{}box\PYGZsq{}: \PYGZob{}\PYGZsq{}type\PYGZsq{}: \PYGZsq{}Polygon\PYGZsq{},
           \PYGZsq{}coordinates\PYGZsq{}: [[[\PYGZhy{}118.668404, 33.704538],
             [\PYGZhy{}118.668404, 34.337041],
             [\PYGZhy{}118.155409, 34.337041],
             [\PYGZhy{}118.155409, 33.704538]]]\PYGZcb{},
          \PYGZsq{}attributes\PYGZsq{}: \PYGZob{}\PYGZcb{}\PYGZcb{},
         \PYGZsq{}contributors\PYGZsq{}: None,
         \PYGZsq{}is\PYGZus{}quote\PYGZus{}status\PYGZsq{}: False,
         \PYGZsq{}quote\PYGZus{}count\PYGZsq{}: 0,
         \PYGZsq{}reply\PYGZus{}count\PYGZsq{}: 0,
         \PYGZsq{}retweet\PYGZus{}count\PYGZsq{}: 0,
         \PYGZsq{}favorite\PYGZus{}count\PYGZsq{}: 0,
         \PYGZsq{}entities\PYGZsq{}: \PYGZob{}\PYGZsq{}hashtags\PYGZsq{}: [],
          \PYGZsq{}urls\PYGZsq{}: [\PYGZob{}\PYGZsq{}url\PYGZsq{}: \PYGZsq{}https://t.co/9kQpNWp4F9\PYGZsq{},
            \PYGZsq{}expanded\PYGZus{}url\PYGZsq{}: \PYGZsq{}https://www.instagram.com/p/BdgPSa5hQrc/\PYGZsq{},
            \PYGZsq{}display\PYGZus{}url\PYGZsq{}: \PYGZsq{}instagram.com/p/BdgPSa5hQrc/\PYGZsq{},
            \PYGZsq{}indices\PYGZsq{}: [96, 119]\PYGZcb{}],
          \PYGZsq{}user\PYGZus{}mentions\PYGZsq{}: [],
          \PYGZsq{}symbols\PYGZsq{}: []\PYGZcb{},
         \PYGZsq{}favorited\PYGZsq{}: False,
         \PYGZsq{}retweeted\PYGZsq{}: False,
         \PYGZsq{}possibly\PYGZus{}sensitive\PYGZsq{}: False,
         \PYGZsq{}filter\PYGZus{}level\PYGZsq{}: \PYGZsq{}low\PYGZsq{},
         \PYGZsq{}lang\PYGZsq{}: \PYGZsq{}en\PYGZsq{},
         \PYGZsq{}timestamp\PYGZus{}ms\PYGZsq{}: \PYGZsq{}1515017764449\PYGZsq{},
         \PYGZsq{}user\PYGZus{}processed\PYGZsq{}: True\PYGZcb{}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [8]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{find}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [9]: }\PYG{n}{cursor}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[9]: }2157100
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [10]: }\PYG{n}{cursor\PYGZus{}sampl} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}
             \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}sample}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{20}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{]}
         \PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [12]: }\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[12]: }[0, 1, 2, 3, 4]
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [13]: }\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor\PYGZus{}sampl}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[13]: }20
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [14]: }\PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{cursor\PYGZus{}sampl}\PYG{p}{)}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
\textcolor{ansi-red}{---------------------------------------------------------------------------}
\textcolor{ansi-red}{StopIteration}                             Traceback (most recent call last)
\textcolor{ansi-green}{<ipython-input-14-96be4d43b38c>} in \textcolor{ansi-cyan}{<module>}\textcolor{ansi-blue}{()}
\textcolor{ansi-green}{----> 1}\textcolor{ansi-red}{ }next\textcolor{ansi-blue}{(}cursor\_sampl\textcolor{ansi-blue}{)}

\textcolor{ansi-green}{/opt/conda/lib/python3.6/site-packages/pymongo/command\_cursor.py} in \textcolor{ansi-cyan}{next}\textcolor{ansi-blue}{(self)}
\textcolor{ansi-green-intense}{\textbf{    290}}             \textcolor{ansi-green}{return} coll\textcolor{ansi-blue}{.}database\textcolor{ansi-blue}{.}\_fix\_outgoing\textcolor{ansi-blue}{(}self\textcolor{ansi-blue}{.}\_\_data\textcolor{ansi-blue}{.}popleft\textcolor{ansi-blue}{(}\textcolor{ansi-blue}{)}\textcolor{ansi-blue}{,} coll\textcolor{ansi-blue}{)}
\textcolor{ansi-green-intense}{\textbf{    291}}         \textcolor{ansi-green}{else}\textcolor{ansi-blue}{:}
\textcolor{ansi-green}{--> 292}\textcolor{ansi-red}{             }\textcolor{ansi-green}{raise} StopIteration
\textcolor{ansi-green-intense}{\textbf{    293}}
\textcolor{ansi-green-intense}{\textbf{    294}}     \_\_next\_\_ \textcolor{ansi-blue}{=} next

\textcolor{ansi-red}{StopIteration}:
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [15]: }\PYG{n}{cursor\PYGZus{}sampl} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}sample}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{]}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [16]: }\PYG{n}{tw} \PYG{o}{=} \PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{cursor\PYGZus{}sampl}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [17]: }\PYG{n}{tw}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[17]: }dict\PYGZus{}keys([\PYGZsq{}\PYGZus{}id\PYGZsq{}, \PYGZsq{}created\PYGZus{}at\PYGZsq{}, \PYGZsq{}id\PYGZsq{}, \PYGZsq{}id\PYGZus{}str\PYGZsq{}, \PYGZsq{}text\PYGZsq{}, \PYGZsq{}display\PYGZus{}text\PYGZus{}range\PYGZsq{}, \PYGZsq{}source\PYGZsq{}, \PYGZsq{}truncated\PYGZsq{}, \PYGZsq{}in\PYGZus{}reply\PYGZus{}to\PYGZus{}status\PYGZus{}id\PYGZsq{}, \PYGZsq{}in\PYGZus{}reply\PYGZus{}to\PYGZus{}status\PYGZus{}id\PYGZus{}str\PYGZsq{}, \PYGZsq{}in\PYGZus{}reply\PYGZus{}to\PYGZus{}user\PYGZus{}id\PYGZsq{}, \PYGZsq{}in\PYGZus{}reply\PYGZus{}to\PYGZus{}user\PYGZus{}id\PYGZus{}str\PYGZsq{}, \PYGZsq{}in\PYGZus{}reply\PYGZus{}to\PYGZus{}screen\PYGZus{}name\PYGZsq{}, \PYGZsq{}user\PYGZsq{}, \PYGZsq{}geo\PYGZsq{}, \PYGZsq{}coordinates\PYGZsq{}, \PYGZsq{}place\PYGZsq{}, \PYGZsq{}contributors\PYGZsq{}, \PYGZsq{}is\PYGZus{}quote\PYGZus{}status\PYGZsq{}, \PYGZsq{}extended\PYGZus{}tweet\PYGZsq{}, \PYGZsq{}quote\PYGZus{}count\PYGZsq{}, \PYGZsq{}reply\PYGZus{}count\PYGZsq{}, \PYGZsq{}retweet\PYGZus{}count\PYGZsq{}, \PYGZsq{}favorite\PYGZus{}count\PYGZsq{}, \PYGZsq{}entities\PYGZsq{}, \PYGZsq{}favorited\PYGZsq{}, \PYGZsq{}retweeted\PYGZsq{}, \PYGZsq{}possibly\PYGZus{}sensitive\PYGZsq{}, \PYGZsq{}filter\PYGZus{}level\PYGZsq{}, \PYGZsq{}lang\PYGZsq{}, \PYGZsq{}timestamp\PYGZus{}ms\PYGZsq{}, \PYGZsq{}user\PYGZus{}processed\PYGZsq{}])
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [18]: }\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{tw}\PYG{o}{.}\PYG{n}{values}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{]}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[18]: }[ObjectId(\PYGZsq{}5a78aacc15ba4c00015664b7\PYGZsq{}),
          \PYGZsq{}Mon Feb 05 19:04:44 +0000 2018\PYGZsq{},
          960590028253446144,
          \PYGZsq{}960590028253446144\PYGZsq{},
          \PYGZsq{}YAAASSSSS!!!! LOVE MY TEAM AND MY CITY @Eagles!!! CONGRATS!! WELL DESERVED LONG AWAITED BUT DAMMIT!! WE GOT IT!!… https://t.co/dEm7aXDF1S\PYGZsq{}]
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [19]: }\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [20]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}sample}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{]}\PYG{p}{)}
         
         \PYG{n}{tw\PYGZus{}sample\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [21]: }\PYG{n}{tw\PYGZus{}sample\PYGZus{}df}\PYG{o}{.}\PYG{n}{dtypes}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[21]: }\PYGZus{}id                           object
         contributors                  object
         coordinates                   object
         created\PYGZus{}at                    object
         display\PYGZus{}text\PYGZus{}range            object
         entities                      object
         extended\PYGZus{}entities             object
         favorite\PYGZus{}count                 int64
         favorited                       bool
         filter\PYGZus{}level                  object
         geo                           object
         id                             int64
         id\PYGZus{}str                        object
         in\PYGZus{}reply\PYGZus{}to\PYGZus{}screen\PYGZus{}name       object
         in\PYGZus{}reply\PYGZus{}to\PYGZus{}status\PYGZus{}id        float64
         in\PYGZus{}reply\PYGZus{}to\PYGZus{}status\PYGZus{}id\PYGZus{}str     object
         in\PYGZus{}reply\PYGZus{}to\PYGZus{}user\PYGZus{}id          float64
         in\PYGZus{}reply\PYGZus{}to\PYGZus{}user\PYGZus{}id\PYGZus{}str       object
         is\PYGZus{}quote\PYGZus{}status                 bool
         lang                          object
         place                         object
         possibly\PYGZus{}sensitive            object
         quote\PYGZus{}count                    int64
         reply\PYGZus{}count                    int64
         retweet\PYGZus{}count                  int64
         retweeted                       bool
         source                        object
         text                          object
         timestamp\PYGZus{}ms                  object
         truncated                       bool
         user                          object
         user\PYGZus{}processed                object
         dtype: object
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [22]: }\PYG{n}{tw\PYGZus{}sample\PYGZus{}df}\PYG{o}{.}\PYG{n}{select\PYGZus{}dtypes}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{int}\PYG{p}{]}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[22]: }favorite\PYGZus{}count                  id  quote\PYGZus{}count  reply\PYGZus{}count  retweet\PYGZus{}count
         0               0  949128180421423110            0            0              0
         1               0  952395937166446592            0            0              0
         2               0  950168161424359425            0            0              0
         3               0  955545267616473089            0            0              0
         4               0  958617919558098944            0            0              0
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [23]: }\PYG{n}{tw\PYGZus{}sample\PYGZus{}df}\PYG{o}{.}\PYG{n}{select\PYGZus{}dtypes}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{float}\PYG{p}{]}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[23]: }in\PYGZus{}reply\PYGZus{}to\PYGZus{}status\PYGZus{}id  in\PYGZus{}reply\PYGZus{}to\PYGZus{}user\PYGZus{}id
         0                    NaN                  NaN
         1                    NaN                  NaN
         2                    NaN                  NaN
         3           9.555443e+17          583038984.0
         4                    NaN                  NaN
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [24]: }\PYG{n}{tw\PYGZus{}sample\PYGZus{}df}\PYG{o}{.}\PYG{n}{select\PYGZus{}dtypes}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{object}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[24]: }\PYGZus{}id contributors coordinates  \PYGZbs{}
         0  5a4ef81fbfe2f9001587ff5a         None        None
         1  5a5adb7436dd5f00015df15b         None        None
         2  5a52c0ae36dd5f000158f176         None        None
         3  5a66507f36dd5f000164b402         None        None
         4  5a717e2136dd5f00016b72de         None        None
         
                                created\PYGZus{}at display\PYGZus{}text\PYGZus{}range  \PYGZbs{}
         0  Fri Jan 05 03:59:26 +0000 2018            [0, 38]
         1  Sun Jan 14 04:24:20 +0000 2018                NaN
         2  Mon Jan 08 00:51:57 +0000 2018            [0, 68]
         3  Mon Jan 22 20:58:39 +0000 2018           [35, 73]
         4  Wed Jan 31 08:28:16 +0000 2018                NaN
         
                                                     entities  \PYGZbs{}
         0  \PYGZob{}\PYGZsq{}hashtags\PYGZsq{}: [], \PYGZsq{}urls\PYGZsq{}: [], \PYGZsq{}user\PYGZus{}mentions\PYGZsq{}: ...
         1  \PYGZob{}\PYGZsq{}hashtags\PYGZsq{}: [], \PYGZsq{}urls\PYGZsq{}: [], \PYGZsq{}user\PYGZus{}mentions\PYGZsq{}: ...
         2  \PYGZob{}\PYGZsq{}hashtags\PYGZsq{}: [\PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}MyTwitterAnniversary\PYGZsq{},...
         3  \PYGZob{}\PYGZsq{}hashtags\PYGZsq{}: [], \PYGZsq{}urls\PYGZsq{}: [], \PYGZsq{}user\PYGZus{}mentions\PYGZsq{}: ...
         4  \PYGZob{}\PYGZsq{}hashtags\PYGZsq{}: [\PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}Tweetlikethe1600s\PYGZsq{}, \PYGZsq{}i...
         
                                            extended\PYGZus{}entities filter\PYGZus{}level   geo  \PYGZbs{}
         0  \PYGZob{}\PYGZsq{}media\PYGZsq{}: [\PYGZob{}\PYGZsq{}id\PYGZsq{}: 949128175698657281, \PYGZsq{}id\PYGZus{}str\PYGZsq{}...          low  None
         1                                                NaN          low  None
         2  \PYGZob{}\PYGZsq{}media\PYGZsq{}: [\PYGZob{}\PYGZsq{}id\PYGZsq{}: 950168155208347648, \PYGZsq{}id\PYGZus{}str\PYGZsq{}...          low  None
         3                                                NaN          low  None
         4                                                NaN          low  None
         
                        id\PYGZus{}str      ...       in\PYGZus{}reply\PYGZus{}to\PYGZus{}status\PYGZus{}id\PYGZus{}str  \PYGZbs{}
         0  949128180421423110      ...                            None
         1  952395937166446592      ...                            None
         2  950168161424359425      ...                            None
         3  955545267616473089      ...              955544344269869056
         4  958617919558098944      ...                            None
         
           in\PYGZus{}reply\PYGZus{}to\PYGZus{}user\PYGZus{}id\PYGZus{}str lang  \PYGZbs{}
         0                    None   en
         1                    None   en
         2                    None   en
         3               583038984   en
         4                    None   en
         
                                                        place possibly\PYGZus{}sensitive  \PYGZbs{}
         0  \PYGZob{}\PYGZsq{}id\PYGZsq{}: \PYGZsq{}3b77caf94bfc81fe\PYGZsq{}, \PYGZsq{}url\PYGZsq{}: \PYGZsq{}https://api...              False
         1  \PYGZob{}\PYGZsq{}id\PYGZsq{}: \PYGZsq{}fbd6d2f5a4e4a15e\PYGZsq{}, \PYGZsq{}url\PYGZsq{}: \PYGZsq{}https://api...                NaN
         2  \PYGZob{}\PYGZsq{}id\PYGZsq{}: \PYGZsq{}3b77caf94bfc81fe\PYGZsq{}, \PYGZsq{}url\PYGZsq{}: \PYGZsq{}https://api...              False
         3  \PYGZob{}\PYGZsq{}id\PYGZsq{}: \PYGZsq{}3b77caf94bfc81fe\PYGZsq{}, \PYGZsq{}url\PYGZsq{}: \PYGZsq{}https://api...                NaN
         4  \PYGZob{}\PYGZsq{}id\PYGZsq{}: \PYGZsq{}3b77caf94bfc81fe\PYGZsq{}, \PYGZsq{}url\PYGZsq{}: \PYGZsq{}https://api...                NaN
         
                                                       source  \PYGZbs{}
         0  \PYGZlt{}a href=\PYGZdq{}http://twitter.com/download/iphone\PYGZdq{} r...
         1  \PYGZlt{}a href=\PYGZdq{}http://twitter.com/download/iphone\PYGZdq{} r...
         2  \PYGZlt{}a href=\PYGZdq{}http://twitter.com/download/iphone\PYGZdq{} r...
         3  \PYGZlt{}a href=\PYGZdq{}http://twitter.com/download/android\PYGZdq{} ...
         4  \PYGZlt{}a href=\PYGZdq{}http://twitter.com/download/iphone\PYGZdq{} r...
         
                                                         text   timestamp\PYGZus{}ms  \PYGZbs{}
         0  This damn album was so overlooked . https:/...  1515124766818
         1  Can’t get over how fine p rod was in 2009 lowk...  1515903860738
         2  Do you remember when you joined Twitter? I do!...  1515372717611
         3  @johnpaulstonard @aiww @TateEtcMag No one has ...  1516654719629
         4  Let me stop perusing \PYGZsh{}Tweetlikethe1600s before...  1517387296939
         
                                                         user user\PYGZus{}processed
         0  \PYGZob{}\PYGZsq{}id\PYGZsq{}: 935285892, \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}935285892\PYGZsq{}, \PYGZsq{}name...            NaN
         1  \PYGZob{}\PYGZsq{}id\PYGZsq{}: 2476155914, \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}2476155914\PYGZsq{}, \PYGZsq{}na...           True
         2  \PYGZob{}\PYGZsq{}id\PYGZsq{}: 2281376473, \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}2281376473\PYGZsq{}, \PYGZsq{}na...           True
         3  \PYGZob{}\PYGZsq{}id\PYGZsq{}: 823668383132487681, \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}82366838...            NaN
         4  \PYGZob{}\PYGZsq{}id\PYGZsq{}: 26182204, \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}26182204\PYGZsq{}, \PYGZsq{}name\PYGZsq{}:...            NaN
         
         [5 rows x 21 columns]
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [25]: }\PYG{n}{tw\PYGZus{}sample\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{created\PYGZus{}at}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{tw\PYGZus{}sample\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{created\PYGZus{}at}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [28]: }\PYG{n}{tw\PYGZus{}sample\PYGZus{}df}\PYG{o}{.}\PYG{n}{created\PYGZus{}at}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[28]: }0   2018\PYGZhy{}01\PYGZhy{}05 03:59:26
         1   2018\PYGZhy{}01\PYGZhy{}14 04:24:20
         2   2018\PYGZhy{}01\PYGZhy{}08 00:51:57
         3   2018\PYGZhy{}01\PYGZhy{}22 20:58:39
         4   2018\PYGZhy{}01\PYGZhy{}31 08:28:16
         Name: created\PYGZus{}at, dtype: datetime64[ns]
\end{Verbatim}


\section{Tweets Containing Geo Information}
\label{\detokenize{04-mongo/04-01-poking-around:Tweets-Containing-Geo-Information}}\label{\detokenize{04-mongo/04-01-poking-around::doc}}

\subsection{DO NOT RUN THIS}
\label{\detokenize{04-mongo/04-01-poking-around:DO-NOT-RUN-THIS}}
\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [31]: }\PYG{n}{contain\PYGZus{}geo\PYGZus{}search} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{find}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{geo}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}ne}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{k+kc}{None}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
         \PYG{n}{contain\PYGZus{}geo\PYGZus{}search}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[31]: }\PYGZlt{}pymongo.cursor.Cursor at 0x7f6b32f11f28\PYGZgt{}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [30]: }\PYG{c+c1}{\PYGZsh{} contain\PYGZus{}geo\PYGZus{}search.count()}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{318373}
\end{sphinxVerbatim}


\section{Distinct Users}
\label{\detokenize{04-mongo/04-01-poking-around:Distinct-Users}}
\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [32]: }\PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{distinct}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{user}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
\textcolor{ansi-red}{---------------------------------------------------------------------------}
\textcolor{ansi-red}{OperationFailure}                          Traceback (most recent call last)
\textcolor{ansi-green}{<ipython-input-32-1172ea4afe07>} in \textcolor{ansi-cyan}{<module>}\textcolor{ansi-blue}{()}
\textcolor{ansi-green}{----> 1}\textcolor{ansi-red}{ }collection\_reference\textcolor{ansi-blue}{.}distinct\textcolor{ansi-blue}{(}\textcolor{ansi-blue}{'user'}\textcolor{ansi-blue}{)}

\textcolor{ansi-green}{/opt/conda/lib/python3.6/site-packages/pymongo/collection.py} in \textcolor{ansi-cyan}{distinct}\textcolor{ansi-blue}{(self, key, filter, session, **kwargs)}
\textcolor{ansi-green-intense}{\textbf{   2446}}             return self.\_command(sock\_info, cmd, slave\_ok,
\textcolor{ansi-green-intense}{\textbf{   2447}}                                  read\_concern\textcolor{ansi-blue}{=}self\textcolor{ansi-blue}{.}read\_concern\textcolor{ansi-blue}{,}
\textcolor{ansi-green}{-> 2448}\textcolor{ansi-red}{                                  collation=collation, session=session)["values"]
}\textcolor{ansi-green-intense}{\textbf{   2449}}
\textcolor{ansi-green-intense}{\textbf{   2450}}     def map\_reduce(self, map, reduce, out, full\_response=False, session=None,

\textcolor{ansi-green}{/opt/conda/lib/python3.6/site-packages/pymongo/collection.py} in \textcolor{ansi-cyan}{\_command}\textcolor{ansi-blue}{(self, sock\_info, command, slave\_ok, read\_preference, codec\_options, check, allowable\_errors, read\_concern, write\_concern, parse\_write\_concern\_error, collation, session, retryable\_write)}
\textcolor{ansi-green-intense}{\textbf{    243}}                 session\textcolor{ansi-blue}{=}s\textcolor{ansi-blue}{,}
\textcolor{ansi-green-intense}{\textbf{    244}}                 client\textcolor{ansi-blue}{=}self\textcolor{ansi-blue}{.}\_\_database\textcolor{ansi-blue}{.}client\textcolor{ansi-blue}{,}
\textcolor{ansi-green}{--> 245}\textcolor{ansi-red}{                 retryable\_write=retryable\_write)
}\textcolor{ansi-green-intense}{\textbf{    246}}
\textcolor{ansi-green-intense}{\textbf{    247}}     \textcolor{ansi-green}{def} \_\_create\textcolor{ansi-blue}{(}self\textcolor{ansi-blue}{,} options\textcolor{ansi-blue}{,} collation\textcolor{ansi-blue}{,} session\textcolor{ansi-blue}{)}\textcolor{ansi-blue}{:}

\textcolor{ansi-green}{/opt/conda/lib/python3.6/site-packages/pymongo/pool.py} in \textcolor{ansi-cyan}{command}\textcolor{ansi-blue}{(self, dbname, spec, slave\_ok, read\_preference, codec\_options, check, allowable\_errors, check\_keys, read\_concern, write\_concern, parse\_write\_concern\_error, collation, session, client, retryable\_write, publish\_events)}
\textcolor{ansi-green-intense}{\textbf{    515}}                            self\textcolor{ansi-blue}{.}max\_bson\_size\textcolor{ansi-blue}{,} read\_concern\textcolor{ansi-blue}{,}
\textcolor{ansi-green-intense}{\textbf{    516}}                            parse\_write\_concern\_error\textcolor{ansi-blue}{=}parse\_write\_concern\_error\textcolor{ansi-blue}{,}
\textcolor{ansi-green}{--> 517}\textcolor{ansi-red}{                            collation=collation)
}\textcolor{ansi-green-intense}{\textbf{    518}}         \textcolor{ansi-green}{except} OperationFailure\textcolor{ansi-blue}{:}
\textcolor{ansi-green-intense}{\textbf{    519}}             \textcolor{ansi-green}{raise}

\textcolor{ansi-green}{/opt/conda/lib/python3.6/site-packages/pymongo/network.py} in \textcolor{ansi-cyan}{command}\textcolor{ansi-blue}{(sock, dbname, spec, slave\_ok, is\_mongos, read\_preference, codec\_options, session, client, check, allowable\_errors, address, check\_keys, listeners, max\_bson\_size, read\_concern, parse\_write\_concern\_error, collation)}
\textcolor{ansi-green-intense}{\textbf{    123}}             helpers.\_check\_command\_response(
\textcolor{ansi-green-intense}{\textbf{    124}}                 response\_doc\textcolor{ansi-blue}{,} \textcolor{ansi-green}{None}\textcolor{ansi-blue}{,} allowable\_errors\textcolor{ansi-blue}{,}
\textcolor{ansi-green}{--> 125}\textcolor{ansi-red}{                 parse\_write\_concern\_error=parse\_write\_concern\_error)
}\textcolor{ansi-green-intense}{\textbf{    126}}     \textcolor{ansi-green}{except} Exception \textcolor{ansi-green}{as} exc\textcolor{ansi-blue}{:}
\textcolor{ansi-green-intense}{\textbf{    127}}         \textcolor{ansi-green}{if} publish\textcolor{ansi-blue}{:}

\textcolor{ansi-green}{/opt/conda/lib/python3.6/site-packages/pymongo/helpers.py} in \textcolor{ansi-cyan}{\_check\_command\_response}\textcolor{ansi-blue}{(response, msg, allowable\_errors, parse\_write\_concern\_error)}
\textcolor{ansi-green-intense}{\textbf{    143}}
\textcolor{ansi-green-intense}{\textbf{    144}}             msg \textcolor{ansi-blue}{=} msg \textcolor{ansi-green}{or} \textcolor{ansi-blue}{"\%s"}
\textcolor{ansi-green}{--> 145}\textcolor{ansi-red}{             }\textcolor{ansi-green}{raise} OperationFailure\textcolor{ansi-blue}{(}msg \textcolor{ansi-blue}{\%} errmsg\textcolor{ansi-blue}{,} code\textcolor{ansi-blue}{,} response\textcolor{ansi-blue}{)}
\textcolor{ansi-green-intense}{\textbf{    146}}
\textcolor{ansi-green-intense}{\textbf{    147}}

\textcolor{ansi-red}{OperationFailure}: distinct too big, 16mb cap
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [1]: }\PYG{c+c1}{\PYGZsh{} !pip install pymongo}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [2]: }\PYG{k+kn}{from} \PYG{n+nn}{pymongo} \PYG{k}{import} \PYG{n}{MongoClient}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [3]: }\PYG{n}{matplotlib} \PYG{n}{inline}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [4]: }\PYG{n}{mongo\PYGZus{}client} \PYG{o}{=} \PYG{n}{MongoClient}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{18.236.138.158}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{27016}\PYG{p}{)}
        \PYG{n}{database\PYGZus{}reference} \PYG{o}{=} \PYG{n}{mongo\PYGZus{}client}\PYG{o}{.}\PYG{n}{twitter}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [5]: }\PYG{n}{collection\PYGZus{}reference} \PYG{o}{=} \PYG{n}{database\PYGZus{}reference}\PYG{o}{.}\PYG{n}{instructor\PYGZus{}test\PYGZus{}group}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [6]: }\PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[6]: }20000
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [7]: }\PYG{n}{cursor\PYGZus{}sampl} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}sample}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{20}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{]}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [8]: }\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor\PYGZus{}sampl}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[8]: }20
\end{Verbatim}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|}
\hline

\sphinxcode{\sphinxupquote{\_id}}
&
\sphinxcode{\sphinxupquote{truncated}}
&
\sphinxcode{\sphinxupquote{user}}
&
\sphinxcode{\sphinxupquote{extended\_tweet}}
&
\sphinxcode{\sphinxupquote{favorited}}
\\
\hline
\sphinxcode{\sphinxupquote{created\_at}}
&
\sphinxcode{\sphinxupquote{in\_reply\_to\_status\_id}}
&
\sphinxcode{\sphinxupquote{geo}}
&
\sphinxcode{\sphinxupquote{quote\_count}}
&
\sphinxcode{\sphinxupquote{retweeted}}
\\
\hline
\sphinxcode{\sphinxupquote{id}}
&
\sphinxcode{\sphinxupquote{in\_reply\_to\_status\_id\_str}}
&
\sphinxcode{\sphinxupquote{coordinates}}
&
\sphinxcode{\sphinxupquote{reply\_count}}
&
\sphinxcode{\sphinxupquote{filter\_level}}
\\
\hline
\sphinxcode{\sphinxupquote{id\_str}}
&
\sphinxcode{\sphinxupquote{in\_reply\_to\_user\_id}}
&
\sphinxcode{\sphinxupquote{place}}
&
\sphinxcode{\sphinxupquote{retweet\_count}}
&
\sphinxcode{\sphinxupquote{lang}}
\\
\hline
\sphinxcode{\sphinxupquote{text}}
&
\sphinxcode{\sphinxupquote{in\_reply\_to\_user\_id\_str}}
&
\sphinxcode{\sphinxupquote{contributors}}
&
\sphinxcode{\sphinxupquote{favorite\_count}}
&
\sphinxcode{\sphinxupquote{timestamp\_ms}}
\\
\hline
\sphinxcode{\sphinxupquote{source}}
&
\sphinxcode{\sphinxupquote{in\_reply\_to\_screen\_name}}
&
\sphinxcode{\sphinxupquote{is\_quote\_status}}
&
\sphinxcode{\sphinxupquote{entities}}
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{image}.png}
\end{figure}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{245tp9}.jpg}
\end{figure}


\section{The Aggregation Pipeline}
\label{\detokenize{04-mongo/04-02-pipelines:The-Aggregation-Pipeline}}\label{\detokenize{04-mongo/04-02-pipelines::doc}}
A call to the aggregation framework defines a pipeline (figure 6.1), the
\sphinxstylestrong{aggregation pipeline}, where the output from each step in the
pipeline provides input to the next step. Each step executes a single
operation on the input documents to transform the input and generate
output documents.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{image1}.png}
\end{figure}


\subsection{Useful Aggregation Pipeline Operations}
\label{\detokenize{04-mongo/04-02-pipelines:Useful-Aggregation-Pipeline-Operations}}\begin{itemize}
\item {} 
\sphinxcode{\sphinxupquote{\$project}} // Specify fields to be placed in the output document.

\item {} 
\sphinxcode{\sphinxupquote{\$match}} // Select documents to be processed, similar to find().

\item {} 
\sphinxcode{\sphinxupquote{\$limit}} // Limit the number of documents to be passed to the next
step.

\item {} 
\sphinxcode{\sphinxupquote{\$skip}} // Skip a specified number of documents.

\item {} 
\sphinxcode{\sphinxupquote{\$unwind}} // Expand an array, generating one output document for
each array entry.

\item {} 
\sphinxcode{\sphinxupquote{\$group}} // Group documents by a specified key.

\item {} 
\sphinxcode{\sphinxupquote{\$sort}} // Sort documents.

\item {} 
\sphinxcode{\sphinxupquote{\$geoNear}} // Select documents near a geospatial location.

\item {} 
\sphinxcode{\sphinxupquote{\$out}} // Write the results of the pipeline to a collection (new in
v2.6).

\item {} 
\sphinxcode{\sphinxupquote{\$redact}} // Control access to certain data (new in v2.6).

\end{itemize}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [9]: }\PYG{n}{PROJECT} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}project}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{n}{MATCH}   \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}match}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{n}{LIMIT}   \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}limit}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{n}{UNWIND}  \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}unwind}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{n}{GROUP}   \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}group}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{n}{SORT}    \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}sort}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{n}{COUNT}   \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}count}\PYG{l+s+s2}{\PYGZdq{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [10]: }\PYG{n}{test\PYGZus{}group} \PYG{o}{=} \PYG{n}{database\PYGZus{}reference}\PYG{o}{.}\PYG{n}{instructor\PYGZus{}test\PYGZus{}group}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [ ]: }\PYG{n}{not\PYGZus{}empty} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}ne}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{k+kc}{None} \PYG{p}{\PYGZcb{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [17]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{test\PYGZus{}group}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{geo}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{not\PYGZus{}empty} \PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{COUNT} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{geo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}
         \PYG{p}{]}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [18]: }\PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[18]: }\PYGZob{}\PYGZsq{}geo\PYGZsq{}: 2952\PYGZcb{}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [19]: }\PYG{n}{match\PYGZus{}non\PYGZus{}null\PYGZus{}geo} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{geo}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{not\PYGZus{}empty} \PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}
         \PYG{n}{count\PYGZus{}geo} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{COUNT} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{geo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}
         
         \PYG{n}{dag\PYGZus{}count\PYGZus{}non\PYGZus{}null\PYGZus{}geo} \PYG{o}{=} \PYG{p}{[}
             \PYG{n}{match\PYGZus{}non\PYGZus{}null\PYGZus{}geo}\PYG{p}{,}
             \PYG{n}{count\PYGZus{}geo}
         \PYG{p}{]}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [20]: }\PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{test\PYGZus{}group}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{n}{dag\PYGZus{}count\PYGZus{}non\PYGZus{}null\PYGZus{}geo}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[20]: }\PYGZob{}\PYGZsq{}geo\PYGZsq{}: 2952\PYGZcb{}
\end{Verbatim}


\subsection{Group Template}
\label{\detokenize{04-mongo/04-02-pipelines:Group-Template}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZob{} \PYGZdl{}group: \PYGZob{} \PYGZus{}id: \PYGZlt{}expression\PYGZgt{}, \PYGZlt{}field1\PYGZgt{}: \PYGZob{} \PYGZlt{}accumulator1\PYGZgt{} : \PYGZlt{}expression1\PYGZgt{} \PYGZcb{}, ... \PYGZcb{} \PYGZcb{}
\end{sphinxVerbatim}


\subsubsection{Accumulators}
\label{\detokenize{04-mongo/04-02-pipelines:Accumulators}}\begin{itemize}
\item {} 
\sphinxcode{\sphinxupquote{\$sum}}

\item {} 
\sphinxcode{\sphinxupquote{\$avg}}

\item {} 
\sphinxcode{\sphinxupquote{\$first}}

\item {} 
\sphinxcode{\sphinxupquote{\$last}}

\item {} 
\sphinxcode{\sphinxupquote{\$max}}

\item {} 
\sphinxcode{\sphinxupquote{\$min}}

\item {} 
\sphinxcode{\sphinxupquote{\$stdDevPop}}

\item {} 
\sphinxcode{\sphinxupquote{\$stdDevSamp}}

\end{itemize}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [33]: }\PYG{n}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}text}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[33]: }\PYGZob{}\PYGZsq{}\PYGZdl{}group\PYGZsq{}: \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}\PYGZdl{}text\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: \PYGZob{}\PYGZsq{}\PYGZdl{}sum\PYGZsq{}: 1\PYGZcb{}\PYGZcb{}\PYGZcb{}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [22]: }\PYG{n}{greater\PYGZus{}than\PYGZus{}10} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}gt}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{10} \PYG{p}{\PYGZcb{}}
         \PYG{n}{sum\PYGZus{}1} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}sum}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{1} \PYG{p}{\PYGZcb{}}
         
         \PYG{k}{def} \PYG{n+nf}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{n}{key}\PYG{p}{)}\PYG{p}{:}
             \PYG{k}{return} \PYG{p}{\PYGZob{}} \PYG{n}{GROUP} \PYG{p}{:} \PYG{p}{\PYGZob{}}
                          \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}}   \PYG{p}{:} \PYG{n}{key}\PYG{p}{,}
                          \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{sum\PYGZus{}1}
                         \PYG{p}{\PYGZcb{}}
                    \PYG{p}{\PYGZcb{}}
         
         \PYG{n}{match\PYGZus{}count\PYGZus{}gt\PYGZus{}10} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{greater\PYGZus{}than\PYGZus{}10} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
         
         \PYG{n}{sort\PYGZus{}by\PYGZus{}count\PYGZus{}descending} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{SORT} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
         
         \PYG{k}{def} \PYG{n+nf}{limit}\PYG{p}{(}\PYG{n}{val}\PYG{p}{)}\PYG{p}{:}
             \PYG{k}{return} \PYG{p}{\PYGZob{}} \PYG{n}{LIMIT} \PYG{p}{:} \PYG{n}{val} \PYG{p}{\PYGZcb{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [26]: }\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{test\PYGZus{}group}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}
             \PYG{p}{[}
                 \PYG{n}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}lang}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
                 \PYG{n}{match\PYGZus{}count\PYGZus{}gt\PYGZus{}10}\PYG{p}{,}
                 \PYG{n}{sort\PYGZus{}by\PYGZus{}count\PYGZus{}descending}\PYG{p}{,}
                 \PYG{n}{limit}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}
             \PYG{p}{]}
         \PYG{p}{)}\PYG{p}{)}
         
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[26]: }[\PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}en\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 16996\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}und\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 1815\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}es\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 295\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}tl\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 126\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}fr\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 121\PYGZcb{}]
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [27]: }\PYG{n}{not\PYGZus{}an\PYGZus{}empty\PYGZus{}array}             \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}ne}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{[}\PYG{p}{]} \PYG{p}{\PYGZcb{}}
         \PYG{n}{match\PYGZus{}non\PYGZus{}empty\PYGZus{}hashtag\PYGZus{}arrays} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{entities.hashtags}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{not\PYGZus{}an\PYGZus{}empty\PYGZus{}array} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
         \PYG{n}{project\PYGZus{}to\PYGZus{}text\PYGZus{}only}           \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{PROJECT} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}entities.hashtags.text}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:}\PYG{l+m+mi}{0} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
         \PYG{n}{unwind\PYGZus{}text}                    \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{UNWIND} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}text}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{\PYGZcb{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [28]: }\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{test\PYGZus{}group}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}
             \PYG{p}{[}
                 \PYG{n}{match\PYGZus{}non\PYGZus{}empty\PYGZus{}hashtag\PYGZus{}arrays}\PYG{p}{,}
                 \PYG{n}{project\PYGZus{}to\PYGZus{}text\PYGZus{}only}\PYG{p}{,}
                 \PYG{n}{unwind\PYGZus{}text}\PYG{p}{,}
                 \PYG{n}{limit}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{)}
             \PYG{p}{]}
         \PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[28]: }[\PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}photos\PYGZsq{}\PYGZcb{},
          \PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}Artist\PYGZsq{}\PYGZcb{},
          \PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}LosAngeles\PYGZsq{}\PYGZcb{},
          \PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}Accounting\PYGZsq{}\PYGZcb{},
          \PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}Job\PYGZsq{}\PYGZcb{},
          \PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}Jobs\PYGZsq{}\PYGZcb{},
          \PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}Hiring\PYGZsq{}\PYGZcb{},
          \PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}CareerArc\PYGZsq{}\PYGZcb{},
          \PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}sanrio\PYGZsq{}\PYGZcb{},
          \PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZsq{}turquoise\PYGZsq{}\PYGZcb{}]
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [29]: }\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{test\PYGZus{}group}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}
             \PYG{p}{[}
                 \PYG{n}{match\PYGZus{}non\PYGZus{}empty\PYGZus{}hashtag\PYGZus{}arrays}\PYG{p}{,}
                 \PYG{n}{project\PYGZus{}to\PYGZus{}text\PYGZus{}only}\PYG{p}{,}
                 \PYG{n}{unwind\PYGZus{}text}\PYG{p}{,}
                 \PYG{n}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}text}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
                 \PYG{n}{match\PYGZus{}count\PYGZus{}gt\PYGZus{}10}\PYG{p}{,}
                 \PYG{n}{sort\PYGZus{}by\PYGZus{}count\PYGZus{}descending}\PYG{p}{,}
                 \PYG{n}{limit}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{)}
             \PYG{p}{]}
         \PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[29]: }[\PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}job\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 395\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}Hiring\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 308\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}LosAngeles\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 286\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}CareerArc\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 240\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}hiring\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 149\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}Job\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 107\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}Jobs\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 107\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}earthquake\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 67\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}LA\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 56\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}losangeles\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 49\PYGZcb{}]
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [34]: }\PYG{n}{job\PYGZus{}hashtags}      \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{job}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jobs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hiring}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{careerarc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
         \PYG{n}{location\PYGZus{}hashtags} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{california}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{losangeles}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{la}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{santamonica}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{glendale}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{paloalto}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
         \PYG{n}{project\PYGZus{}to\PYGZus{}lower}  \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{PROJECT} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}toLower}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}text}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
         \PYG{n}{match\PYGZus{}not\PYGZus{}in\PYGZus{}bad}  \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}nin}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{job\PYGZus{}hashtags} \PYG{o}{+} \PYG{n}{location\PYGZus{}hashtags}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [35]: }\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{test\PYGZus{}group}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}
             \PYG{p}{[}
                 \PYG{n}{match\PYGZus{}non\PYGZus{}empty\PYGZus{}hashtag\PYGZus{}arrays}\PYG{p}{,}
                 \PYG{n}{project\PYGZus{}to\PYGZus{}text\PYGZus{}only}\PYG{p}{,}
                 \PYG{n}{unwind\PYGZus{}text}\PYG{p}{,}
                 \PYG{n}{project\PYGZus{}to\PYGZus{}lower}\PYG{p}{,}
                 \PYG{n}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}text}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
                 \PYG{n}{match\PYGZus{}not\PYGZus{}in\PYGZus{}bad}\PYG{p}{,}
                 \PYG{n}{match\PYGZus{}count\PYGZus{}gt\PYGZus{}10}\PYG{p}{,}
                 \PYG{n}{sort\PYGZus{}by\PYGZus{}count\PYGZus{}descending}\PYG{p}{,}
                 \PYG{n}{limit}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{)}
             \PYG{p}{]}
         \PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[35]: }[\PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}earthquake\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 67\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}goldenglobes\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 56\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}quake\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 46\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}art\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 40\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}healthcare\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 38\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}superbowl\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 28\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}retail\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 26\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}sales\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 25\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}rn\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 25\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}marketing\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 25\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}gonancygo\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 24\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}hospitality\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 23\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}grammys\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 22\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}repost\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 22\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}it\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 21\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}releasethememo\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 21\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}timesup\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 19\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}nsng\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 19\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}love\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 19\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}clerical\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 18\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}businessmgmt\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 17\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}tv\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 17\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}hollywood\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 16\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}trumpshutdown\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 16\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}script\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 16\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}beverlyhills\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 15\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}dtla\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 15\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}comedy\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 15\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}actorslife\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 14\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}nursing\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 14\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}iheartawards\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 14\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}trump\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 14\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}tbt\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 13\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}finance\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 13\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}fashion\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 13\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}photography\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 13\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}music\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 12\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}veterans\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 11\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}actor\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 11\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}pilot\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 11\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}actors\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 11\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}smile\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 11\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: \PYGZsq{}lincoln\PYGZsq{}, \PYGZsq{}count\PYGZsq{}: 11\PYGZcb{}]
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [1]: }\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
        \PYG{k+kn}{from} \PYG{n+nn}{pymongo} \PYG{k}{import} \PYG{n}{MongoClient}
        \PYG{k+kn}{import} \PYG{n+nn}{random}
        
        \PYG{k+kn}{from} \PYG{n+nn}{mongo\PYGZus{}aggregation\PYGZus{}verbs} \PYG{k}{import} \PYG{o}{*}
        
        \PYG{n}{mongo\PYGZus{}client} \PYG{o}{=} \PYG{n}{MongoClient}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{18.236.138.158}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{27016}\PYG{p}{)}
        \PYG{n}{database\PYGZus{}reference} \PYG{o}{=} \PYG{n}{mongo\PYGZus{}client}\PYG{o}{.}\PYG{n}{twitter}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [2]: }\PYG{n}{database\PYGZus{}reference}\PYG{o}{.}\PYG{n}{collection\PYGZus{}names}\PYG{p}{(}\PYG{p}{)}
        
        \PYG{n}{collection\PYGZus{}reference} \PYG{o}{=} \PYG{n}{database\PYGZus{}reference}\PYG{o}{.}\PYG{n}{instructor\PYGZus{}test\PYGZus{}group}
        
        \PYG{n}{test\PYGZus{}group} \PYG{o}{=} \PYG{n}{database\PYGZus{}reference}\PYG{o}{.}\PYG{n}{instructor\PYGZus{}test\PYGZus{}group}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [3]: }\PYG{n}{match\PYGZus{}empty\PYGZus{}url\PYGZus{}arrays} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{entities.urls}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{[}\PYG{p}{]} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
        
        \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{test\PYGZus{}group}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}
            \PYG{p}{[}
                \PYG{n}{match\PYGZus{}empty\PYGZus{}url\PYGZus{}arrays}\PYG{p}{,}
                \PYG{p}{\PYGZob{}} \PYG{n}{COUNT} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{\PYGZcb{}}
            \PYG{p}{]}
        \PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[3]: }[\PYGZob{}\PYGZsq{}text\PYGZsq{}: 11121\PYGZcb{}]
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [4]: }\PYG{n}{job\PYGZus{}hashtags} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{job}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jobs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hiring}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{careerarc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
        \PYG{n}{location\PYGZus{}hashtags} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{california}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{losangeles}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{la}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{santamonica}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{glendale}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{paloalto}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
        \PYG{n}{match\PYGZus{}not\PYGZus{}in\PYGZus{}bad} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}in}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{job\PYGZus{}hashtags} \PYG{o}{+} \PYG{n}{location\PYGZus{}hashtags} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
        \PYG{n}{project\PYGZus{}to\PYGZus{}text\PYGZus{}keep\PYGZus{}id} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{PROJECT} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}entities.hashtags.text}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
        \PYG{n}{project\PYGZus{}to\PYGZus{}id} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{n}{PROJECT} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{1} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
        
        \PYG{n}{bad\PYGZus{}ids} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{test\PYGZus{}group}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}
            \PYG{p}{[}
                \PYG{n}{match\PYGZus{}non\PYGZus{}empty\PYGZus{}hashtag\PYGZus{}arrays}\PYG{p}{,}
                \PYG{n}{project\PYGZus{}to\PYGZus{}text\PYGZus{}keep\PYGZus{}id}\PYG{p}{,}
                \PYG{n}{unwind\PYGZus{}text}\PYG{p}{,}
                \PYG{n}{project\PYGZus{}to\PYGZus{}lower}\PYG{p}{,}
                \PYG{n}{match\PYGZus{}not\PYGZus{}in\PYGZus{}bad}\PYG{p}{,}
                \PYG{n}{project\PYGZus{}to\PYGZus{}id}
            \PYG{p}{]}
        \PYG{p}{)}\PYG{p}{)}
        \PYG{n}{bad\PYGZus{}ids}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{bad\PYGZus{}ids}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[4]: }([\PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a73683636dd5f00016c7fad\PYGZsq{})\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a73683636dd5f00016c7fad\PYGZsq{})\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a73683636dd5f00016c7fad\PYGZsq{})\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a73683636dd5f00016c7fad\PYGZsq{})\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a73683636dd5f00016c7fad\PYGZsq{})\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a6da1bd36dd5f0001690696\PYGZsq{})\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a6da1bd36dd5f0001690696\PYGZsq{})\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a6da1bd36dd5f0001690696\PYGZsq{})\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a6df39136dd5f0001691533\PYGZsq{})\PYGZcb{},
          \PYGZob{}\PYGZsq{}\PYGZus{}id\PYGZsq{}: ObjectId(\PYGZsq{}5a6df39136dd5f0001691533\PYGZsq{})\PYGZcb{}],
         1835)
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [5]: }\PYG{n}{bad\PYGZus{}ids} \PYG{o}{=} \PYG{p}{[}\PYG{n}{bad\PYGZus{}id}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{k}{for} \PYG{n}{bad\PYGZus{}id} \PYG{o+ow}{in} \PYG{n}{bad\PYGZus{}ids}\PYG{p}{]}
        \PYG{n}{bad\PYGZus{}ids}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{]}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[5]: }[ObjectId(\PYGZsq{}5a73683636dd5f00016c7fad\PYGZsq{}),
         ObjectId(\PYGZsq{}5a73683636dd5f00016c7fad\PYGZsq{}),
         ObjectId(\PYGZsq{}5a73683636dd5f00016c7fad\PYGZsq{}),
         ObjectId(\PYGZsq{}5a73683636dd5f00016c7fad\PYGZsq{}),
         ObjectId(\PYGZsq{}5a73683636dd5f00016c7fad\PYGZsq{}),
         ObjectId(\PYGZsq{}5a6da1bd36dd5f0001690696\PYGZsq{}),
         ObjectId(\PYGZsq{}5a6da1bd36dd5f0001690696\PYGZsq{}),
         ObjectId(\PYGZsq{}5a6da1bd36dd5f0001690696\PYGZsq{}),
         ObjectId(\PYGZsq{}5a6df39136dd5f0001691533\PYGZsq{}),
         ObjectId(\PYGZsq{}5a6df39136dd5f0001691533\PYGZsq{})]
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [6]: }\PYG{n}{not\PYGZus{}in\PYGZus{}bad\PYGZus{}ids} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}nin}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{bad\PYGZus{}ids} \PYG{p}{\PYGZcb{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [8]: }\PYG{n}{not\PYGZus{}in\PYGZus{}bad\PYGZus{}ids\PYGZus{}and\PYGZus{}no\PYGZus{}url} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}}           \PYG{p}{:} \PYG{n}{not\PYGZus{}in\PYGZus{}bad\PYGZus{}ids}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{entities.urls}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{[}\PYG{p}{]}
        \PYG{p}{\PYGZcb{}}
        
        \PYG{n}{just\PYGZus{}the\PYGZus{}text} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{p}{:} \PYG{l+m+mi}{0}
        \PYG{p}{\PYGZcb{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [9]: }\PYG{n}{test\PYGZus{}group}\PYG{o}{.}\PYG{n}{find\PYGZus{}one}\PYG{p}{(}
            \PYG{n}{not\PYGZus{}in\PYGZus{}bad\PYGZus{}ids\PYGZus{}and\PYGZus{}no\PYGZus{}url}\PYG{p}{,}
            \PYG{n}{just\PYGZus{}the\PYGZus{}text}
        \PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[9]: }\PYGZob{}\PYGZsq{}text\PYGZsq{}: \PYGZdq{}@SincerelyLegit Lol why at night? If it\PYGZsq{}s boring I\PYGZsq{}ll fall asleep\PYGZdq{}\PYGZcb{}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [10]: }\PYG{n}{cur}  \PYG{o}{=} \PYG{n}{test\PYGZus{}group}\PYG{o}{.}\PYG{n}{find}\PYG{p}{(}
             \PYG{n}{not\PYGZus{}in\PYGZus{}bad\PYGZus{}ids\PYGZus{}and\PYGZus{}no\PYGZus{}url}\PYG{p}{,}
             \PYG{n}{just\PYGZus{}the\PYGZus{}text}
         \PYG{p}{)}
         
         \PYG{n}{tweets} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cur}\PYG{p}{)}
         \PYG{n}{tweet\PYGZus{}text} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [11]: }\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{tweet\PYGZus{}text}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[11]: }11102
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [12]: }\PYG{n}{tweet\PYGZus{}text}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[12]: }text
         0  @SincerelyLegit Lol why at night? If it\PYGZsq{}s bori...
         1                                   @godtributes Lol
         2  @KingBeyonceStan I need to binge on both now b...
         3  @\PYGZus{}QUEENSharnay Naw I’d i can’t put this skip o...
         4  @sannicolaso I have things to do at home but y...
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [13]: }\PYG{n}{tweet\PYGZus{}text}\PYG{o}{.}\PYG{n}{text} \PYG{o}{=} \PYG{n}{tweet\PYGZus{}text}\PYG{o}{.}\PYG{n}{text}\PYG{o}{.}\PYG{n}{str}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{http}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{S+\textbar{}www.}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{S+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{case}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [ ]: }\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{datasets} \PYG{k}{import} \PYG{n}{fetch\PYGZus{}20newsgroups}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [14]: }\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{feature\PYGZus{}extraction}\PYG{n+nn}{.}\PYG{n+nn}{text} \PYG{k}{import} \PYG{n}{TfidfVectorizer}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [15]: }\PYG{n}{tfidf} \PYG{o}{=} \PYG{n}{TfidfVectorizer}\PYG{p}{(}\PYG{n}{stop\PYGZus{}words}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{english}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
         \PYG{n}{tfidf}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{tweet\PYGZus{}text}\PYG{o}{.}\PYG{n}{text}\PYG{p}{)}
         \PYG{n}{word\PYGZus{}occurence} \PYG{o}{=} \PYG{n}{tfidf}\PYG{o}{.}\PYG{n}{transform}\PYG{p}{(}\PYG{n}{tweet\PYGZus{}text}\PYG{o}{.}\PYG{n}{text}\PYG{p}{)}\PYG{o}{.}\PYG{n}{todense}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [16]: }\PYG{n}{word\PYGZus{}occurence}\PYG{o}{.}\PYG{n}{shape}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[16]: }(11102, 20582)
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [17]: }\PYG{n}{words} \PYG{o}{=} \PYG{n}{tfidf}\PYG{o}{.}\PYG{n}{get\PYGZus{}feature\PYGZus{}names}\PYG{p}{(}\PYG{p}{)}
         \PYG{n}{word\PYGZus{}sample} \PYG{o}{=} \PYG{n}{random}\PYG{o}{.}\PYG{n}{sample}\PYG{p}{(}\PYG{n}{words}\PYG{p}{,} \PYG{l+m+mi}{20}\PYG{p}{)}
         \PYG{n}{word\PYGZus{}occurence\PYGZus{}m} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{word\PYGZus{}occurence}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{n}{words}\PYG{p}{)}
         \PYG{n}{word\PYGZus{}occurence\PYGZus{}m}\PYG{p}{[}\PYG{n}{word\PYGZus{}sample}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[17]: }tires  awesomeeeee  odds  clout  100brbr  total  holy  bluejays  newyork  \PYGZbs{}
         0    0.0          0.0   0.0    0.0      0.0    0.0   0.0       0.0      0.0
         1    0.0          0.0   0.0    0.0      0.0    0.0   0.0       0.0      0.0
         2    0.0          0.0   0.0    0.0      0.0    0.0   0.0       0.0      0.0
         3    0.0          0.0   0.0    0.0      0.0    0.0   0.0       0.0      0.0
         4    0.0          0.0   0.0    0.0      0.0    0.0   0.0       0.0      0.0
         
            thatkiddez  picklerinn  fortunate  witnessed  rl\PYGZus{}miller  bob  carmella  \PYGZbs{}
         0         0.0         0.0        0.0        0.0        0.0  0.0       0.0
         1         0.0         0.0        0.0        0.0        0.0  0.0       0.0
         2         0.0         0.0        0.0        0.0        0.0  0.0       0.0
         3         0.0         0.0        0.0        0.0        0.0  0.0       0.0
         4         0.0         0.0        0.0        0.0        0.0  0.0       0.0
         
            danrather  westla  betsy  brinamoniquee
         0        0.0     0.0    0.0            0.0
         1        0.0     0.0    0.0            0.0
         2        0.0     0.0    0.0            0.0
         3        0.0     0.0    0.0            0.0
         4        0.0     0.0    0.0            0.0
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [18]: }\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{decomposition} \PYG{k}{import} \PYG{n}{LatentDirichletAllocation}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [19]: }\PYG{n}{lda} \PYG{o}{=} \PYG{n}{LatentDirichletAllocation}\PYG{p}{(}\PYG{n}{n\PYGZus{}topics}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{learning\PYGZus{}method}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{batch}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
         \PYG{n}{lda}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{word\PYGZus{}occurence}\PYG{p}{)}
\end{Verbatim}



%
\begin{OriginalVerbatim}[commandchars=\\\{\}]
/opt/conda/lib/python3.6/site-packages/sklearn/decomposition/online\_lda.py:294: DeprecationWarning: n\_topics has been renamed to n\_components in version 0.19 and will be removed in 0.21
  DeprecationWarning)
\end{OriginalVerbatim}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[19]: }LatentDirichletAllocation(batch\PYGZus{}size=128, doc\PYGZus{}topic\PYGZus{}prior=None,
                      evaluate\PYGZus{}every=\PYGZhy{}1, learning\PYGZus{}decay=0.7,
                      learning\PYGZus{}method=\PYGZsq{}batch\PYGZsq{}, learning\PYGZus{}offset=10.0,
                      max\PYGZus{}doc\PYGZus{}update\PYGZus{}iter=100, max\PYGZus{}iter=10, mean\PYGZus{}change\PYGZus{}tol=0.001,
                      n\PYGZus{}components=10, n\PYGZus{}jobs=1, n\PYGZus{}topics=10, perp\PYGZus{}tol=0.1,
                      random\PYGZus{}state=None, topic\PYGZus{}word\PYGZus{}prior=None,
                      total\PYGZus{}samples=1000000.0, verbose=0)
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [20]: }\PYG{n}{lda\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{lda}\PYG{o}{.}\PYG{n}{components\PYGZus{}}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{n}{words}\PYG{p}{)}\PYG{o}{.}\PYG{n}{T}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [21]: }\PYG{k}{def} \PYG{n+nf}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{n}{index}\PYG{p}{,} \PYG{n}{threshold}\PYG{p}{)}\PYG{p}{:}
             \PYG{k}{return} \PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{[}\PYG{n}{lda\PYGZus{}df}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]} \PYG{o}{\PYGZgt{}} \PYG{n}{threshold}\PYG{p}{]}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]}
                     \PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{ascending}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [22]: }\PYG{n}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[22]: }realdonaldtrump    26.924098
         life               14.433196
         today              13.796060
         like               12.909203
         tonight            12.440967
         hi                 11.932545
         lol                11.809768
         just               11.709171
         thank              10.415115
         lo                 10.157741
         Name: 0, dtype: float64
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [23]: }\PYG{n}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[23]: }good       17.543596
         god        16.114882
         morning    13.859482
         just       13.609985
         day        13.163371
         thank      10.265703
         Name: 1, dtype: float64
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [24]: }\PYG{n}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[24]: }don     17.529542
         mood    15.397384
         wow     13.017690
         time    12.512149
         gt      12.051757
         like    11.812582
         just    11.767592
         Name: 2, dtype: float64
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [30]: }\PYG{n}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[30]: }good     11.035873
         gonna     9.677585
         la        9.457188
         right     8.257726
         just      7.964738
         true      6.918964
         need      6.860816
         like      6.785791
         ass       6.449890
         heart     5.911852
         tired     5.898605
         music     5.106587
         omg       5.063022
         Name: 3, dtype: float64
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [26]: }\PYG{n}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[26]: }love     17.597504
         just     15.784500
         like     11.736119
         wait     11.312292
         today    10.499123
         Name: 4, dtype: float64
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [27]: }\PYG{n}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[27]: }fuck      19.533498
         just      19.283515
         yes       16.218575
         people    15.788082
         know      15.775503
         like      15.591380
         love      13.543071
         don       12.154129
         bitch     11.227335
         wanna     10.108777
         lol       10.100001
         Name: 5, dtype: float64
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [28]: }\PYG{n}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[28]: }love       24.931024
         good       11.150954
         angeles     9.569691
         sleep       9.182882
         omg         9.061345
         los         8.237702
         best        7.957185
         going       7.851733
         really      7.655026
         like        7.567627
         lol         7.551425
         couldn      7.519786
         care        7.317565
         just        7.006165
         fall        6.931113
         smh         6.906545
         today       6.660393
         time        6.586684
         getting     6.421132
         day         6.249168
         Name: 6, dtype: float64
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [29]: }\PYG{n}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{l+m+mi}{7}\PYG{p}{,} \PYG{l+m+mi}{7}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[29]: }like      20.469175
         lmao      14.012189
         got       13.858762
         really    12.019327
         just      11.643017
         great     11.011661
         want      10.680874
         need       9.494232
         money      9.130007
         make       8.750701
         didn       8.128451
         lol        7.969240
         love       7.931216
         crazy      7.606814
         say        7.390890
         know       7.127195
         Name: 7, dtype: float64
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [ ]: }\PYG{n}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{7}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [ ]: }\PYG{n}{filter\PYGZus{}topic}\PYG{p}{(}\PYG{n}{lda\PYGZus{}df}\PYG{p}{,} \PYG{l+m+mi}{9}\PYG{p}{,} \PYG{l+m+mi}{7}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [1]: }\PYG{o}{!}pip install folium \PYGZhy{}\PYGZhy{}quiet
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [2]: }\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
        \PYG{k+kn}{from} \PYG{n+nn}{pymongo} \PYG{k}{import} \PYG{n}{MongoClient}
        
        \PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} inline
        
        \PYG{n}{mongo\PYGZus{}client} \PYG{o}{=} \PYG{n}{MongoClient}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{18.236.138.158}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{27016}\PYG{p}{)}
        \PYG{n}{database\PYGZus{}reference} \PYG{o}{=} \PYG{n}{mongo\PYGZus{}client}\PYG{o}{.}\PYG{n}{twitter}
\end{Verbatim}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|}
\hline

\sphinxcode{\sphinxupquote{\_id}}
&
\sphinxcode{\sphinxupquote{truncated}}
&
\sphinxcode{\sphinxupquote{user}}
&
\sphinxcode{\sphinxupquote{extended\_tweet}}
&
\sphinxcode{\sphinxupquote{favorited}}
\\
\hline
\sphinxcode{\sphinxupquote{created\_at}}
&
\sphinxcode{\sphinxupquote{in\_reply\_to\_status\_id}}
&
\sphinxcode{\sphinxupquote{geo}}
&
\sphinxcode{\sphinxupquote{quote\_count}}
&
\sphinxcode{\sphinxupquote{retweeted}}
\\
\hline
\sphinxcode{\sphinxupquote{id}}
&
\sphinxcode{\sphinxupquote{in\_reply\_to\_status\_id\_str}}
&
\sphinxcode{\sphinxupquote{coordinates}}
&
\sphinxcode{\sphinxupquote{reply\_count}}
&
\sphinxcode{\sphinxupquote{filter\_level}}
\\
\hline
\sphinxcode{\sphinxupquote{id\_str}}
&
\sphinxcode{\sphinxupquote{in\_reply\_to\_user\_id}}
&
\sphinxcode{\sphinxupquote{place}}
&
\sphinxcode{\sphinxupquote{retweet\_count}}
&
\sphinxcode{\sphinxupquote{lang}}
\\
\hline
\sphinxcode{\sphinxupquote{text}}
&
\sphinxcode{\sphinxupquote{in\_reply\_to\_user\_id\_str}}
&
\sphinxcode{\sphinxupquote{contributors}}
&
\sphinxcode{\sphinxupquote{favorite\_count}}
&
\sphinxcode{\sphinxupquote{timestamp\_ms}}
\\
\hline
\sphinxcode{\sphinxupquote{source}}
&
\sphinxcode{\sphinxupquote{in\_reply\_to\_screen\_name}}
&
\sphinxcode{\sphinxupquote{is\_quote\_status}}
&
\sphinxcode{\sphinxupquote{entities}}
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{image}.png}
\end{figure}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [3]: }\PYG{n}{collection\PYGZus{}reference} \PYG{o}{=} \PYG{n}{database\PYGZus{}reference}\PYG{o}{.}\PYG{n}{instructor\PYGZus{}test\PYGZus{}group}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [4]: }\PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[4]: }20000
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [6]: }\PYG{k+kn}{from} \PYG{n+nn}{mongo\PYGZus{}aggregation\PYGZus{}verbs} \PYG{k}{import} \PYG{o}{*}
\end{Verbatim}


\section{Tweets By Day}
\label{\detokenize{04-mongo/04-04-time-and-space:Tweets-By-Day}}\label{\detokenize{04-mongo/04-04-time-and-space::doc}}
\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [7]: }\PYG{n}{datestring\PYGZus{}created\PYGZus{}at} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dateString}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}created\PYGZus{}at}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}
        \PYG{n}{date\PYGZus{}from\PYGZus{}string} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}dateFromString}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{datestring\PYGZus{}created\PYGZus{}at} \PYG{p}{\PYGZcb{}}
        
        \PYG{n}{date\PYGZus{}to\PYGZus{}id} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{n}{PROJECT} \PYG{p}{:} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{0}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{year}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}year}\PYG{l+s+s2}{\PYGZdq{}}       \PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{date}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{date\PYGZus{}from\PYGZus{}string}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{month}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}month}\PYG{l+s+s2}{\PYGZdq{}}      \PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{date}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{date\PYGZus{}from\PYGZus{}string}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{day}\PYG{l+s+s2}{\PYGZdq{}}   \PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}dayOfMonth}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{date}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{date\PYGZus{}from\PYGZus{}string}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{p}{\PYGZcb{}}
        \PYG{p}{\PYGZcb{}}
        
        \PYG{n}{group\PYGZus{}by\PYGZus{}date} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{n}{GROUP} \PYG{p}{:} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{tweets}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}sum}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{1} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{year}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}year}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{month}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}month}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{day}\PYG{l+s+s2}{\PYGZdq{}}   \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}day}\PYG{l+s+s2}{\PYGZdq{}}
                \PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{p}{\PYGZcb{}}
        \PYG{p}{\PYGZcb{}}
        
        
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [8]: }\PYG{k}{def} \PYG{n+nf}{dictionary\PYGZus{}to\PYGZus{}datestring}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{month} \PYG{o}{=} \PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
            \PYG{n}{day}   \PYG{o}{=} \PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
            \PYG{n}{year}  \PYG{o}{=} \PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{year}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
            \PYG{k}{return} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}\PYGZcb{}}\PYG{l+s+s2}{\PYGZhy{}}\PYG{l+s+si}{\PYGZob{}\PYGZcb{}}\PYG{l+s+s2}{\PYGZhy{}}\PYG{l+s+si}{\PYGZob{}\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}\PYG{n}{month}\PYG{p}{,} \PYG{n}{day}\PYG{p}{,} \PYG{n}{year}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [9]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}
            \PYG{n}{date\PYGZus{}to\PYGZus{}id}\PYG{p}{,}
            \PYG{n}{group\PYGZus{}by\PYGZus{}date}
        \PYG{p}{]}\PYG{p}{)}
        
        \PYG{n}{daily\PYGZus{}tweets} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [10]: }\PYG{n}{datestrings} \PYG{o}{=} \PYG{n}{daily\PYGZus{}tweets}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{n}{dictionary\PYGZus{}to\PYGZus{}datestring}\PYG{p}{)}
         \PYG{n}{daily\PYGZus{}tweets}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{datestrings}\PYG{p}{)}
         
         \PYG{n}{daily\PYGZus{}tweets}\PYG{o}{.}\PYG{n}{drop}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{inplace}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
         \PYG{n}{daily\PYGZus{}tweets}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{inplace}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
         \PYG{n}{daily\PYGZus{}tweets}\PYG{o}{.}\PYG{n}{set\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{inplace}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
         \PYG{n}{daily\PYGZus{}tweets}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[10]: }\PYGZlt{}matplotlib.axes.\PYGZus{}subplots.AxesSubplot at 0x7f33956f1f28\PYGZgt{}
\end{Verbatim}

\noindent\sphinxincludegraphics{{04-mongo_04-04-time-and-space_11_1}.png}


\section{Tweet Locations}
\label{\detokenize{04-mongo/04-04-time-and-space:Tweet-Locations}}
\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [11]: }\PYG{n}{not\PYGZus{}null} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}ne}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{k+kc}{None} \PYG{p}{\PYGZcb{}}
         \PYG{n}{nonnull\PYGZus{}geo} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{geo}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{n}{not\PYGZus{}null} \PYG{p}{\PYGZcb{}}
         \PYG{n}{keep\PYGZus{}geo} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{geo}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{l+m+mi}{1} \PYG{p}{\PYGZcb{}}
         
         \PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{find}\PYG{p}{(}\PYG{n}{nonnull\PYGZus{}geo}\PYG{p}{,} \PYG{n}{keep\PYGZus{}geo}\PYG{p}{)}
         \PYG{n}{cursor}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[11]: }2952
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [12]: }\PYG{n}{geo\PYGZus{}tweets} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [23]: }\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{geo\PYGZus{}tweets}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{geo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[23]: }[\PYGZob{}\PYGZsq{}type\PYGZsq{}: \PYGZsq{}Point\PYGZsq{}, \PYGZsq{}coordinates\PYGZsq{}: [34.18016221, \PYGZhy{}118.60321147]\PYGZcb{},
          \PYGZob{}\PYGZsq{}type\PYGZsq{}: \PYGZsq{}Point\PYGZsq{}, \PYGZsq{}coordinates\PYGZsq{}: [33.98752, \PYGZhy{}118.4538]\PYGZcb{},
          \PYGZob{}\PYGZsq{}type\PYGZsq{}: \PYGZsq{}Point\PYGZsq{}, \PYGZsq{}coordinates\PYGZsq{}: [34.1517492, \PYGZhy{}118.5214282]\PYGZcb{},
          \PYGZob{}\PYGZsq{}type\PYGZsq{}: \PYGZsq{}Point\PYGZsq{}, \PYGZsq{}coordinates\PYGZsq{}: [34.6495, \PYGZhy{}120.07927]\PYGZcb{},
          \PYGZob{}\PYGZsq{}type\PYGZsq{}: \PYGZsq{}Point\PYGZsq{}, \PYGZsq{}coordinates\PYGZsq{}: [33.9275, \PYGZhy{}118.27722]\PYGZcb{}]
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [21]: }\PYG{k}{def} \PYG{n+nf}{parse\PYGZus{}geo\PYGZus{}from\PYGZus{}tweets}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{)}\PYG{p}{:}
             \PYG{n}{geo} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{geo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}\PYG{p}{)}
             \PYG{k}{return} \PYG{n}{geo}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [22]: }\PYG{n}{geo} \PYG{o}{=} \PYG{n}{parse\PYGZus{}geo\PYGZus{}from\PYGZus{}tweets}\PYG{p}{(}\PYG{n}{geo\PYGZus{}tweets}\PYG{p}{)}
         \PYG{n}{geo}\PYG{o}{.}\PYG{n}{sample}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[22]: }coordinates   type
         1269          [32.6865, \PYGZhy{}117.1583]  Point
         1082  [34.13641722, \PYGZhy{}118.35336765]  Point
         1575            [36.758, \PYGZhy{}121.587]  Point
         1385         [34.26867, \PYGZhy{}118.1257]  Point
         731   [36.48863024, \PYGZhy{}119.72972051]  Point
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [24]: }\PYG{k+kn}{import} \PYG{n+nn}{folium}
         \PYG{n}{starting\PYGZus{}loc} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mf}{34.0689}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{118.4452}\PYG{p}{]}
         \PYG{n}{la\PYGZus{}map} \PYG{o}{=} \PYG{n}{folium}\PYG{o}{.}\PYG{n}{Map}\PYG{p}{(}\PYG{n}{location}\PYG{o}{=}\PYG{n}{starting\PYGZus{}loc}\PYG{p}{,} \PYG{n}{zoom\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{13}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [26]: }\PYG{n}{geo}\PYG{o}{.}\PYG{n}{coordinates}\PYG{o}{.}\PYG{n}{values}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[26]: }array([[34.18016221, \PYGZhy{}118.60321147], [33.98752, \PYGZhy{}118.4538],
                [34.1517492, \PYGZhy{}118.5214282], ..., [33.96789, \PYGZhy{}118.32806],
                [33.74972064, \PYGZhy{}116.7024919], [34.313861, \PYGZhy{}118.534847]], dtype=object)
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [27]: }\PYG{k}{for} \PYG{n}{loc} \PYG{o+ow}{in} \PYG{n}{geo}\PYG{o}{.}\PYG{n}{coordinates}\PYG{p}{:}
             \PYG{n}{folium}\PYG{o}{.}\PYG{n}{Marker}\PYG{p}{(}\PYG{n}{loc}\PYG{p}{)}\PYG{o}{.}\PYG{n}{add\PYGZus{}to}\PYG{p}{(}\PYG{n}{la\PYGZus{}map}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [28]: }\PYG{n}{la\PYGZus{}map}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[28]: }\PYGZlt{}folium.folium.Map at 0x7f3394cdfd30\PYGZgt{}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [1]: }\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
        \PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
        \PYG{k+kn}{from} \PYG{n+nn}{pymongo} \PYG{k}{import} \PYG{n}{MongoClient}
        
        \PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} inline
        
        \PYG{n}{mongo\PYGZus{}client} \PYG{o}{=} \PYG{n}{MongoClient}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{18.236.138.158}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{27016}\PYG{p}{)}
        \PYG{n}{database\PYGZus{}reference} \PYG{o}{=} \PYG{n}{mongo\PYGZus{}client}\PYG{o}{.}\PYG{n}{twitter}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [2]: }\PYG{k+kn}{from} \PYG{n+nn}{mongo\PYGZus{}aggregation\PYGZus{}verbs} \PYG{k}{import} \PYG{o}{*}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [3]: }\PYG{n}{collection\PYGZus{}reference} \PYG{o}{=} \PYG{n}{database\PYGZus{}reference}\PYG{o}{.}\PYG{n}{instructor\PYGZus{}test\PYGZus{}group}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [4]: }\PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[4]: }20000
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [6]: }\PYG{n}{INSTAGRAM} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZlt{}a href=}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{http://instagram.com}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{ rel=}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{nofollow}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{\PYGZgt{}Instagram\PYGZlt{}/a\PYGZgt{}}\PYG{l+s+s1}{\PYGZsq{}}
        \PYG{n}{source\PYGZus{}is\PYGZus{}instagram} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{source}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{n}{INSTAGRAM} \PYG{p}{\PYGZcb{}}
        \PYG{n}{source\PYGZus{}is\PYGZus{}not\PYGZus{}instagram} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{source}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}ne}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{n}{INSTAGRAM} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [7]: }\PYG{p}{(}\PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{find}\PYG{p}{(}\PYG{n}{source\PYGZus{}is\PYGZus{}instagram}\PYG{p}{)}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
         \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{find}\PYG{p}{(}\PYG{n}{source\PYGZus{}is\PYGZus{}not\PYGZus{}instagram}\PYG{p}{)}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[7]: }(1907, 18093)
\end{Verbatim}


\section{Tweet Locations}
\label{\detokenize{04-mongo/04-05-device-and-geo:Tweet-Locations}}\label{\detokenize{04-mongo/04-05-device-and-geo::doc}}
\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [8]: }\PYG{n}{not\PYGZus{}null} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}ne}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{k+kc}{None} \PYG{p}{\PYGZcb{}}
        \PYG{n}{nonnull\PYGZus{}geo} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{geo}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{n}{not\PYGZus{}null} \PYG{p}{\PYGZcb{}}
        \PYG{n}{keep\PYGZus{}geo\PYGZus{}and\PYGZus{}text} \PYG{o}{=} \PYG{p}{\PYGZob{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{geo}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{text}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{l+m+mi}{1} \PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}
        
        \PYG{n}{match\PYGZus{}insta} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{source\PYGZus{}is\PYGZus{}instagram}
        \PYG{p}{\PYGZcb{}}
        
        \PYG{n}{match\PYGZus{}not\PYGZus{}insta} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{source\PYGZus{}is\PYGZus{}not\PYGZus{}instagram}
        \PYG{p}{\PYGZcb{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [9]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}
            \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{source\PYGZus{}is\PYGZus{}instagram} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{nonnull\PYGZus{}geo}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{p}{\PYGZob{}} \PYG{n}{COUNT} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{geo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}
        \PYG{p}{]}\PYG{p}{)}
        \PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[9]: }\PYGZob{}\PYGZsq{}geo\PYGZsq{}: 1907\PYGZcb{}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [10]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{source\PYGZus{}is\PYGZus{}not\PYGZus{}instagram} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{nonnull\PYGZus{}geo}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{COUNT} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{geo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}
         \PYG{p}{]}\PYG{p}{)}
         \PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[10]: }\PYGZob{}\PYGZsq{}geo\PYGZsq{}: 1045\PYGZcb{}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [11]: }\PYG{k}{def} \PYG{n+nf}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{n}{key}\PYG{p}{)}\PYG{p}{:}
             \PYG{k}{return} \PYG{p}{\PYGZob{}} \PYG{n}{GROUP} \PYG{p}{:} \PYG{p}{\PYGZob{}}
                          \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}}   \PYG{p}{:} \PYG{n}{key}\PYG{p}{,}
                          \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}sum}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{1} \PYG{p}{\PYGZcb{}}
                         \PYG{p}{\PYGZcb{}}
                    \PYG{p}{\PYGZcb{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [12]: }\PYG{k}{def} \PYG{n+nf}{parse\PYGZus{}geo\PYGZus{}from\PYGZus{}tweets}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{)}\PYG{p}{:}
             \PYG{n}{tweets} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{)}
             \PYG{n}{geo} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}\PYG{p}{)}
             \PYG{n}{geo}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{tweets}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
             \PYG{k}{return} \PYG{n}{geo}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [14]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{source\PYGZus{}is\PYGZus{}not\PYGZus{}instagram} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{nonnull\PYGZus{}geo}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{n}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}geo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}gt}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{14} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{SORT}  \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
         \PYG{p}{]}\PYG{p}{)}
         \PYG{n}{not\PYGZus{}insta} \PYG{o}{=} \PYG{n}{parse\PYGZus{}geo\PYGZus{}from\PYGZus{}tweets}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}\PYG{p}{)}
         \PYG{n}{not\PYGZus{}insta}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[14]: }coordinates   type  count
         0  [34.0522342, \PYGZhy{}118.2436849]  Point    206
         1  [37.3813444, \PYGZhy{}122.1802812]  Point     39
         2   [34.1425078, \PYGZhy{}118.255075]  Point     31
         3   [36.778261, \PYGZhy{}119.4179324]  Point     21
         4        [35.426667, \PYGZhy{}116.89]  Point     17
         5   [34.0508369, \PYGZhy{}118.263032]  Point     16
         6  [34.0194543, \PYGZhy{}118.4911912]  Point     15
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [15]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{source\PYGZus{}is\PYGZus{}instagram} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{nonnull\PYGZus{}geo}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{n}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}geo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}gt}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{14} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{SORT}  \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}
         \PYG{p}{]}\PYG{p}{)}
         \PYG{n}{insta} \PYG{o}{=} \PYG{n}{parse\PYGZus{}geo\PYGZus{}from\PYGZus{}tweets}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}\PYG{p}{)}
         \PYG{n}{insta}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[15]: }coordinates   type  count
         0           [34.0522, \PYGZhy{}118.243]  Point    465
         1  [36.48863024, \PYGZhy{}119.72972051]  Point     37
         2  [34.09799334, \PYGZhy{}118.33866453]  Point     35
         3  [34.07305556, \PYGZhy{}118.39944444]  Point     29
         4           [34.0221, \PYGZhy{}118.481]  Point     27
         5    [34.0402214, \PYGZhy{}118.2545227]  Point     16
         6    [33.9442368, \PYGZhy{}118.3975983]  Point     15
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [16]: }\PYG{k+kn}{import} \PYG{n+nn}{folium}
         \PYG{n}{starting\PYGZus{}loc} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mf}{34.0689}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{118.4452}\PYG{p}{]}
         \PYG{n}{la\PYGZus{}map} \PYG{o}{=} \PYG{n}{folium}\PYG{o}{.}\PYG{n}{Map}\PYG{p}{(}\PYG{n}{location}\PYG{o}{=}\PYG{n}{starting\PYGZus{}loc}\PYG{p}{,} \PYG{n}{zoom\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [17]: }\PYG{k}{for} \PYG{n}{loc}\PYG{p}{,} \PYG{n}{count} \PYG{o+ow}{in} \PYG{n}{not\PYGZus{}insta}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{coordinates}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{:}
             \PYG{n}{popup} \PYG{o}{=} \PYG{n}{folium}\PYG{o}{.}\PYG{n}{Popup}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{count}\PYG{p}{)}\PYG{p}{,} \PYG{n}{parse\PYGZus{}html}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
             \PYG{n}{folium}\PYG{o}{.}\PYG{n}{Marker}\PYG{p}{(}\PYG{n}{loc}\PYG{p}{,} \PYG{n}{popup}\PYG{o}{=}\PYG{n}{popup}\PYG{p}{,} \PYG{n}{icon}\PYG{o}{=}\PYG{n}{folium}\PYG{o}{.}\PYG{n}{Icon}\PYG{p}{(}\PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{add\PYGZus{}to}\PYG{p}{(}\PYG{n}{la\PYGZus{}map}\PYG{p}{)}
         \PYG{k}{for} \PYG{n}{loc}\PYG{p}{,} \PYG{n}{count} \PYG{o+ow}{in} \PYG{n}{insta}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{coordinates}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{:}
             \PYG{n}{popup} \PYG{o}{=} \PYG{n}{folium}\PYG{o}{.}\PYG{n}{Popup}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{count}\PYG{p}{)}\PYG{p}{,} \PYG{n}{parse\PYGZus{}html}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
             \PYG{n}{folium}\PYG{o}{.}\PYG{n}{Marker}\PYG{p}{(}\PYG{n}{loc}\PYG{p}{,} \PYG{n}{popup}\PYG{o}{=}\PYG{n}{popup}\PYG{p}{,} \PYG{n}{icon}\PYG{o}{=}\PYG{n}{folium}\PYG{o}{.}\PYG{n}{Icon}\PYG{p}{(}\PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{add\PYGZus{}to}\PYG{p}{(}\PYG{n}{la\PYGZus{}map}\PYG{p}{)}
         
         
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [18]: }\PYG{n}{la\PYGZus{}map}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[18]: }\PYGZlt{}folium.folium.Map at 0x7ffa7de7e1d0\PYGZgt{}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [19]: }\PYG{k}{def} \PYG{n+nf}{parse\PYGZus{}geo\PYGZus{}from\PYGZus{}tweets}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{)}\PYG{p}{:}
             \PYG{n}{tweets} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{)}
             \PYG{n}{geo} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}\PYG{p}{)}
             \PYG{n}{geo}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{tweets}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
             \PYG{k}{return} \PYG{n}{geo}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [20]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{source\PYGZus{}is\PYGZus{}not\PYGZus{}instagram} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{nonnull\PYGZus{}geo}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{n}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}user.id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}gt}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{14} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{SORT}  \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{LIMIT} \PYG{p}{:} \PYG{l+m+mi}{10} \PYG{p}{\PYGZcb{}}
         \PYG{p}{]}\PYG{p}{)}
         \PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}users} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}\PYG{p}{)}
         \PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}users}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[20]: }\PYGZus{}id  count
         0  4549072827     29
         1   787687147     29
         2  1414684496     27
         3  3066057658     27
         4   789990810     27
         5  4191239027     25
         6    21298660     21
         7  3864064936     19
         8    21298373     19
         9  3380828067     17
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [21]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{source\PYGZus{}is\PYGZus{}instagram} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{nonnull\PYGZus{}geo}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{n}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}user.id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
         \PYG{c+c1}{\PYGZsh{}     \PYGZob{} MATCH : \PYGZob{} \PYGZdq{}count\PYGZdq{} : \PYGZob{} \PYGZdq{}\PYGZdl{}gt\PYGZdq{} : 10 \PYGZcb{} \PYGZcb{} \PYGZcb{},}
             \PYG{p}{\PYGZob{}} \PYG{n}{SORT}  \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{count}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{LIMIT} \PYG{p}{:} \PYG{l+m+mi}{10} \PYG{p}{\PYGZcb{}}
         \PYG{p}{]}\PYG{p}{)}
         \PYG{n}{insta\PYGZus{}top\PYGZus{}users} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}\PYG{p}{)}
         \PYG{n}{insta\PYGZus{}top\PYGZus{}users}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[21]: }\PYGZus{}id  count
         0          1455659006     10
         1           613833206      8
         2  843390093012353024      6
         3          4561143733      6
         4            19640448      5
         5           226456467      5
         6            37016954      4
         7  760160463833313280      4
         8            30723561      4
         9          2267807461      4
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [22]: }\PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids} \PYG{o}{=} \PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}users}\PYG{o}{.}\PYG{n}{\PYGZus{}id}\PYG{o}{.}\PYG{n}{values}
         \PYG{n}{insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids} \PYG{o}{=} \PYG{n}{insta\PYGZus{}top\PYGZus{}users}\PYG{o}{.}\PYG{n}{\PYGZus{}id}\PYG{o}{.}\PYG{n}{values}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [23]: }\PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids\PYGZus{}list} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids}\PYG{p}{)}
         \PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids\PYGZus{}list}\PYG{p}{]}
         \PYG{n}{insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids\PYGZus{}list} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids}\PYG{p}{)}
         \PYG{n}{insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n}{insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids\PYGZus{}list}\PYG{p}{]}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [24]: }\PYG{k}{def} \PYG{n+nf}{parse\PYGZus{}geo\PYGZus{}from\PYGZus{}tweets}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{)}\PYG{p}{:}
             \PYG{n}{tweets} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{)}
             \PYG{n}{tmp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{tweets}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}\PYG{p}{)}
             \PYG{n}{geo} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{tmp}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{geo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{)}\PYG{p}{)}
             \PYG{n}{geo}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{user\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{tmp}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{user\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
             \PYG{n}{geo}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{tweets}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
             \PYG{k}{return} \PYG{n}{geo}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [25]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{source\PYGZus{}is\PYGZus{}not\PYGZus{}instagram} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{nonnull\PYGZus{}geo}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{PROJECT} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{user\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}user.id}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{geo}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:}\PYG{l+m+mi}{0} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{user\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}in}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids\PYGZus{}list} \PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{n}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{user\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}user\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{geo}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}geo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{,}
         \PYG{p}{]}\PYG{p}{)}
         
         \PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}user\PYGZus{}geo} \PYG{o}{=} \PYG{n}{parse\PYGZus{}geo\PYGZus{}from\PYGZus{}tweets}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [26]: }\PYG{n}{cursor} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{aggregate}\PYG{p}{(}\PYG{p}{[}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{source\PYGZus{}is\PYGZus{}instagram} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{n}{nonnull\PYGZus{}geo}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{PROJECT} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{user\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}user.id}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{geo}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:}\PYG{l+m+mi}{0} \PYG{p}{\PYGZcb{}} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{p}{\PYGZob{}} \PYG{n}{MATCH} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{user\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}in}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{n}{insta\PYGZus{}top\PYGZus{}users\PYGZus{}ids\PYGZus{}list} \PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
             \PYG{n}{group\PYGZus{}and\PYGZus{}count}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{user\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}user\PYGZus{}id}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{geo}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}geo}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{,}
         \PYG{p}{]}\PYG{p}{)}
         \PYG{n}{insta\PYGZus{}top\PYGZus{}user\PYGZus{}geo} \PYG{o}{=} \PYG{n}{parse\PYGZus{}geo\PYGZus{}from\PYGZus{}tweets}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cursor}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [27]: }\PYG{n}{not\PYGZus{}insta\PYGZus{}top\PYGZus{}user\PYGZus{}geo}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[27]: }coordinates   type     user\PYGZus{}id  count
         0  [34.19743613, \PYGZhy{}118.58178967]  Point  4549072827      1
         1        [34.03491, \PYGZhy{}118.27746]  Point  4191239027      1
         2     [35.7476654, \PYGZhy{}118.060997]  Point  1414684496      1
         3         [34.0995, \PYGZhy{}118.32813]  Point  4191239027      1
         4     [34.187044, \PYGZhy{}118.3812562]  Point   789990810      1
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [28]: }\PYG{n}{insta\PYGZus{}top\PYGZus{}user\PYGZus{}geo}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[28]: }coordinates   type     user\PYGZus{}id  count
         0  [34.04453451, \PYGZhy{}118.26677639]  Point   226456467      1
         1  [34.06895637, \PYGZhy{}118.40267947]  Point  1455659006      1
         2           [34.0221, \PYGZhy{}118.481]  Point  1455659006      1
         3  [34.07305556, \PYGZhy{}118.39944444]  Point  1455659006      5
         4  [34.08718311, \PYGZhy{}118.46354276]  Point    19640448      1
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [55]: }\PYG{n}{colors\PYGZus{}insta} \PYG{o}{=} \PYG{p}{\PYGZob{}}
             \PYG{l+m+mi}{760160463833313280} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+m+mi}{30723561} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+m+mi}{613833206} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+m+mi}{2267807461} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{purple}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+m+mi}{4561143733} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{orange}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+m+mi}{1455659006} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{darkred}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+m+mi}{37016954} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lightred}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+m+mi}{19640448} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{beige}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+m+mi}{843390093012353024} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{darkblue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+m+mi}{226456467} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{darkgreen}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
         \PYG{p}{\PYGZcb{}}
         
         \PYG{c+c1}{\PYGZsh{} colors\PYGZus{}insta = \PYGZob{}}
         \PYG{c+c1}{\PYGZsh{}     760160463833313280 : \PYGZsq{}\PYGZsh{}0000ff\PYGZsq{},}
         \PYG{c+c1}{\PYGZsh{}     30723561 : \PYGZsq{}\PYGZsh{}0010ff\PYGZsq{},}
         \PYG{c+c1}{\PYGZsh{}     613833206 : \PYGZsq{}\PYGZsh{}0020ff\PYGZsq{},}
         \PYG{c+c1}{\PYGZsh{}     2267807461 : \PYGZsq{}\PYGZsh{}0030ff\PYGZsq{},}
         \PYG{c+c1}{\PYGZsh{}     4561143733 : \PYGZsq{}\PYGZsh{}0040ff\PYGZsq{},}
         \PYG{c+c1}{\PYGZsh{}     1455659006 : \PYGZsq{}\PYGZsh{}0050ff\PYGZsq{},}
         \PYG{c+c1}{\PYGZsh{}     37016954 : \PYGZsq{}\PYGZsh{}0060ff\PYGZsq{},}
         \PYG{c+c1}{\PYGZsh{}     19640448 : \PYGZsq{}\PYGZsh{}0070ff\PYGZsq{},}
         \PYG{c+c1}{\PYGZsh{}     843390093012353024 : \PYGZsq{}\PYGZsh{}0080ff\PYGZsq{},}
         \PYG{c+c1}{\PYGZsh{}     226456467 : \PYGZsq{}\PYGZsh{}0090ff\PYGZsq{},}
         \PYG{c+c1}{\PYGZsh{} \PYGZcb{}}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [56]: }\PYG{c+c1}{\PYGZsh{} not\PYGZus{}insta\PYGZus{}top\PYGZus{}user\PYGZus{}geo[\PYGZsq{}color\PYGZsq{}] = not\PYGZus{}insta\PYGZus{}top\PYGZus{}user\PYGZus{}geo.user\PYGZus{}id.apply(lambda x: colors\PYGZus{}not\PYGZus{}insta[x])}
         \PYG{n}{insta\PYGZus{}top\PYGZus{}user\PYGZus{}geo}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{color}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{insta\PYGZus{}top\PYGZus{}user\PYGZus{}geo}\PYG{o}{.}\PYG{n}{user\PYGZus{}id}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{colors\PYGZus{}insta}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [57]: }\PYG{n}{insta\PYGZus{}top\PYGZus{}user\PYGZus{}geo}\PYG{o}{.}\PYG{n}{sample}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[57]: }coordinates   type             user\PYGZus{}id  count      color
         14           [34.0304, \PYGZhy{}118.779]  Point          2267807461      1     purple
         2            [34.0221, \PYGZhy{}118.481]  Point          1455659006      1    darkred
         5    [34.0981334, \PYGZhy{}118.32668656]  Point          4561143733      2     orange
         12           [34.0522, \PYGZhy{}118.243]  Point          2267807461      2     purple
         19  [34.06635491, \PYGZhy{}118.41345382]  Point            19640448      1      beige
         7       [34.122322, \PYGZhy{}118.223444]  Point  760160463833313280      4        red
         21           [33.7358, \PYGZhy{}118.291]  Point           226456467      4  darkgreen
         11  [34.07517256, \PYGZhy{}118.35229982]  Point          2267807461      1     purple
         15    [34.0567207, \PYGZhy{}118.4424515]  Point            19640448      1      beige
         9            [34.0522, \PYGZhy{}118.243]  Point            30723561      4       blue
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [58]: }\PYG{n}{starting\PYGZus{}loc} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mf}{34.0689}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{118.4452}\PYG{p}{]}
         \PYG{n}{la\PYGZus{}map} \PYG{o}{=} \PYG{n}{folium}\PYG{o}{.}\PYG{n}{Map}\PYG{p}{(}\PYG{n}{location}\PYG{o}{=}\PYG{n}{starting\PYGZus{}loc}\PYG{p}{,} \PYG{n}{zoom\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [59]: }\PYG{k}{for} \PYG{n}{loc}\PYG{p}{,} \PYG{n}{color}\PYG{p}{,} \PYG{n}{count} \PYG{o+ow}{in} \PYG{n}{insta\PYGZus{}top\PYGZus{}user\PYGZus{}geo}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{coordinates}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{color}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{:}
             \PYG{n}{popup} \PYG{o}{=} \PYG{n}{folium}\PYG{o}{.}\PYG{n}{Popup}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{count}\PYG{p}{)}\PYG{p}{,} \PYG{n}{parse\PYGZus{}html}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
             \PYG{k}{if} \PYG{n}{count} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{3}\PYG{p}{:}
                 \PYG{n}{folium}\PYG{o}{.}\PYG{n}{Marker}\PYG{p}{(}\PYG{n}{loc}\PYG{p}{,} \PYG{n}{popup}\PYG{o}{=}\PYG{n}{popup}\PYG{p}{,} \PYG{n}{icon}\PYG{o}{=}\PYG{n}{folium}\PYG{o}{.}\PYG{n}{Icon}\PYG{p}{(}\PYG{n}{color}\PYG{o}{=}\PYG{n}{color}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{add\PYGZus{}to}\PYG{p}{(}\PYG{n}{la\PYGZus{}map}\PYG{p}{)}
         \PYG{c+c1}{\PYGZsh{}     else:}
         \PYG{c+c1}{\PYGZsh{}         folium.Marker(loc, popup=popup, icon=folium.Icon(color=color, icon=\PYGZsq{}warning\PYGZsq{})).add\PYGZus{}to(la\PYGZus{}map)}
         \PYG{c+c1}{\PYGZsh{} for loc, count in insta[[\PYGZsq{}coordinates\PYGZsq{},\PYGZsq{}count\PYGZsq{}]].values:}
         \PYG{c+c1}{\PYGZsh{}     folium.Marker(loc, popup=popup, icon=folium.Icon(color=\PYGZsq{}blue\PYGZsq{})).add\PYGZus{}to(la\PYGZus{}map)}
         
         
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [60]: }\PYG{n}{la\PYGZus{}map}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[60]: }\PYGZlt{}folium.folium.Map at 0x7ffa7654c1d0\PYGZgt{}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{760160463833313280} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+m+mi}{30723561} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+m+mi}{613833206} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+m+mi}{2267807461} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{purple}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+m+mi}{4561143733} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{orange}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+m+mi}{1455659006} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{darkred}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+m+mi}{37016954} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lightred}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+m+mi}{19640448} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{beige}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+m+mi}{843390093012353024} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{darkblue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{l+m+mi}{226456467} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{darkgreen}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [65]: }\PYG{n}{cur} \PYG{o}{=} \PYG{n}{collection\PYGZus{}reference}\PYG{o}{.}\PYG{n}{find}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{user.id}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{:} \PYG{l+m+mi}{37016954}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
         \PYG{n}{tw} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{cur}\PYG{p}{)}
         \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{tw}\PYG{p}{)}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{text}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{user}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[65]: }text  \PYGZbs{}
         0  Thanks for the support • Be A Leader • Shop \PYGZam{}a...
         1  They’ll quit on themselves to find excuses to ...
         2  Thanks for the support • The latest singles fr...
         3  Thanks for the support • The latest singles fr...
         
                                                         user
         0  \PYGZob{}\PYGZsq{}id\PYGZsq{}: 37016954, \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}37016954\PYGZsq{}, \PYGZsq{}name\PYGZsq{}:...
         1  \PYGZob{}\PYGZsq{}id\PYGZsq{}: 37016954, \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}37016954\PYGZsq{}, \PYGZsq{}name\PYGZsq{}:...
         2  \PYGZob{}\PYGZsq{}id\PYGZsq{}: 37016954, \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}37016954\PYGZsq{}, \PYGZsq{}name\PYGZsq{}:...
         3  \PYGZob{}\PYGZsq{}id\PYGZsq{}: 37016954, \PYGZsq{}id\PYGZus{}str\PYGZsq{}: \PYGZsq{}37016954\PYGZsq{}, \PYGZsq{}name\PYGZsq{}:...
\end{Verbatim}


\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{Index}
\printindex
\end{document}