<!DOCTYPE html>


<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Build a Jupyter-Redis Application with Docker Compose &mdash; Engineering For Data Science  documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/styles.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/slides.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    
    
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/common.js"></script>
    
    <script type="text/javascript" src="../../_static/slides.js"></script>
    <script type="text/javascript" src="../../_static/sync.js"></script>
    <script type="text/javascript" src="../../_static/controller.js"></script>
    <script type="text/javascript" src="../../_static/init.js"></script>
    
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="Engineering For Data Science  documentation" href="../../index.html" /> 
  </head>
  <body>

<section
   id="slide_container"
   class='slides layout-regular'>


  
<article class="slide level-1" id="Build-a-Jupyter-Redis-Application-with-Docker-Compose">

<h1>Build a Jupyter-Redis Application with Docker Compose</h1>

<p>Next we will build a Docker Compose application to be a Jupyter Notebook
Server running in conjunction with a Redis server.</p>
<div class="figure">
<img alt="" src="../../_images/jup-redis.png" />
</div>
<p>In the root directory for this chapter, we have a file called
<code class="docutils literal notranslate"><span class="pre">docker-</span> <span class="pre">compose.yml</span></code> which defines this application.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">version</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span>
<span class="n">services</span><span class="p">:</span>
    <span class="n">this_jupyter</span><span class="p">:</span>
        <span class="n">build</span><span class="p">:</span> <span class="n">docker</span><span class="o">/</span><span class="n">jupyter</span>
        <span class="n">ports</span><span class="p">:</span>
            <span class="o">-</span> <span class="s2">&quot;80:8888&quot;</span>
        <span class="n">volumes</span><span class="p">:</span>
            <span class="o">-</span> <span class="o">.</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jovyan</span>
    <span class="n">this_redis</span><span class="p">:</span>
       <span class="n">image</span><span class="p">:</span> <span class="n">redis</span>
       <span class="n">volumes</span><span class="p">:</span>
           <span class="o">-</span> <span class="n">redis_data</span><span class="p">:</span><span class="o">/</span><span class="n">data</span>
<span class="n">volumes</span><span class="p">:</span>
    <span class="n">redis_data</span><span class="p">:</span>
</pre></div>
</div>
<p>The Compose file defines two services: <code class="docutils literal notranslate"><span class="pre">this_jupyter</span></code> and
<code class="docutils literal notranslate"><span class="pre">this_redis</span></code> and a volume, <code class="docutils literal notranslate"><span class="pre">redis_data</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">this_jupyter</span></code> service:</p>
<ul class="simple">
<li>Uses the <code class="docutils literal notranslate"><span class="pre">build:</span></code> keyword to define the service, meaning it will
use a <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> to build the image defining the service.</li>
<li>Uses a <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> contained in the <code class="docutils literal notranslate"><span class="pre">docker/jupyter</span></code></li>
<li>Attaches the local directory (<code class="docutils literal notranslate"><span class="pre">.</span></code>) to the (hopefully familiar)
jupyter <code class="docutils literal notranslate"><span class="pre">WORKDIR</span></code>, <code class="docutils literal notranslate"><span class="pre">/home/jovyan</span></code>, as specified by the
<code class="docutils literal notranslate"><span class="pre">volumes:</span></code> keyword.</li>
<li>Forwards the exposed port <code class="docutils literal notranslate"><span class="pre">8888</span></code> to the port <code class="docutils literal notranslate"><span class="pre">8000</span></code> on the host
machine, as specified by the <code class="docutils literal notranslate"><span class="pre">ports:</span></code> keyword.</li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">this_redis</span></code> service:</p>
<ul class="simple">
<li>Uses the <code class="docutils literal notranslate"><span class="pre">image:</span></code> keyword to define the service, meaning it will
pull an image from the Docker Hub registry.</li>
<li>Uses the <code class="docutils literal notranslate"><span class="pre">redis</span></code> image.</li>
<li>Attaches the volume <code class="docutils literal notranslate"><span class="pre">redis_data</span></code> to the <code class="docutils literal notranslate"><span class="pre">redis</span></code> <code class="docutils literal notranslate"><span class="pre">WORKDIR</span></code>,
<code class="docutils literal notranslate"><span class="pre">/data</span></code>, as specified by the <code class="docutils literal notranslate"><span class="pre">volumes:</span></code> keyword.</li>
</ul>
<p><strong>:math:`square` Note</strong> The definition of every container defined in a
<code class="docutils literal notranslate"><span class="pre">docker-compose.yml</span></code> file must begin with either the <code class="docutils literal notranslate"><span class="pre">image:</span></code>
keyword or the <code class="docutils literal notranslate"><span class="pre">build:</span></code> keyword.</p>




</article>
<article class="slide level-2" id="Run-Your-Application-with-Compose">

<h2>Run Your Application with Compose</h2>

<p>Now, you use the <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code> command line tool to start the
application. You will use the <code class="docutils literal notranslate"><span class="pre">-d</span></code> argument to specify that you wish
to launch the application in detached mode.</p>
<p>Listing 9-8. Start the Compose Application jupyter_redis</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker-compose up -d
Creating network &quot;05-redis_default&quot; with the default driver
Creating volume &quot;05-redis_redis_data&quot; with default driver
Building this_jupyter
Step 1/3 : FROM jupyter/datascience-notebook
 ---&gt; 52b41d2a15ba
Step 2/3 : RUN conda install --yes redis
 ---&gt; Running in f16856f4ce4e
</pre></div>
</div>
<p>Creating network “ch9jupyterredis_default” with the default driver
Creating ch9jupyterredis_this_redis_1 Creating
ch9jupyterredis_this_jupyter_1</p>
<p>The docker-compose up command first instructs the Docker Engine to
either 1. Check the local image cache for the specified image if the
container definition begins with the image: keyword. 2. Build the image
from a referenced Dockerfile if the container definition begins with the
build: keyword. Here, you have passed an image: keyword for both
containers. In this case, both images with which you are working are
currently in your image cache. Were they not in the cache, the Docker
engine would pull them from Docker Hub. Next, the docker-compose up
command instructs the Docker engine to create a network over which the
application’s containers can communicate. Here, a network called
ch9jupyterredis_default was created. Listing 9-14 shows how to use this
network. Finally, the docker-compose up command instructs the Docker
engine to create the containers defined in the docker-compose.yml file.
This is equivalent to running the two commands in Listing 9-9, with one
exception: the connection created by docker-compose is superior to the
link created by a –link flag, as you will see in a moment.</p>




</article>

</section>

<section id="slide_notes">

</section>

  </body>
</html>